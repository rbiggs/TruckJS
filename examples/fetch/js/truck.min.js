!function(self){"use strict";var DOMStack=function(){function DOMStack(args){if(this.array=[],this.length=0,Array.isArray(args))for(var i=-1,len=args.length;++i<len;)this.array[i]=args[i];else if(args)if(args===document)this.array[0]=document;else{var array=Array.prototype.slice.apply(arguments);array.forEach(function(ctx,idx){this.array[idx]=ctx})}}return DOMStack.prototype.eq=function(index){var ret=new DOMStack;if(!this.size())return ret;var temp;return 0>index?(temp=this.array[this.array.length+index],ret.push(temp)):(temp=this.array[index],ret.push(temp)),ret[0]=ret.array[0],ret.length=ret.array.length,ret},DOMStack.prototype.push=function(data){this.array.push(data),this.length=this.array.length,this[0]=this.array[0]},DOMStack.prototype.pop=function(){return this.length=this.array.length-1,this.array.pop()},DOMStack.prototype.unshift=function(data){this.array.unshift(data),this[0]=this.array[0],this.length=this.array.length},DOMStack.prototype.shift=function(){return this.length=this.array.length-1,this.array.shift()},DOMStack.prototype.size=function(){return this.array.length},DOMStack.prototype.forEach=function(callback){for(var value,i=0,len=this.array.length;len>i&&(value=callback.call(this.array[i],this.array[i],i),value!==!1);i++);},DOMStack.prototype.each=function(callback){for(var value,i=0,len=this.array.length;len>i&&(value=callback.call(this.array[i],i,this.array[i]),value!==!1);i++);},DOMStack.prototype.slice=function(){var ret=new DOMStack;return ret.concat(this.array.slice.apply(this.array,arguments)),ret.length=ret.array.length,ret},DOMStack.prototype.splice=function(){return this.array.splice.apply(this.array,arguments),this[0]=this.array[0],this},DOMStack.prototype.sort=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];this.array.sort.apply(this.array,arguments),this[0]=this.array[0]},DOMStack.prototype.sortBy=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];var orderBy=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];var props=args;return function(a,b){for(var sortByProperty=function(property){var sortOrder=1;return"-"===property[0]&&(sortOrder=-1,property=property.substr(1)),function(a,b){var result=a[property]<b[property]?-1:a[property]>b[property]?1:0;return result*sortOrder}},i=0,result=0,numberOfProperties=props.length;0===result&&numberOfProperties>i;)result=sortByProperty(props[i])(a,b),i++;return result}};return this.array.sort(orderBy.apply(null,args)),this[0]=this.array[0],this},DOMStack.prototype.filter=function(){for(var ret=new DOMStack,args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];return ret.concat(this.array.filter.apply(this.array,args)),ret[0]=ret.array[0],ret},DOMStack.prototype.map=function(){for(var ret=new DOMStack,args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];return ret.concat(this.array.map.apply(this.array,args)),ret[0]=ret.array[0],ret},DOMStack.prototype.concat=function(collection){var len,temp,i=-1;for(Array.isArray(collection)?(temp=collection,len=temp.length):collection.constructor.toString().match(/DOMStack/)?(temp=collection.getData(),len=temp.length):collection.constructor.toString().match(/HTMLBodyElementConstructor/)&&(temp=[collection],len=1);++i<len;)this.array[this.array.length]=temp[i];this[0]=this.array[0],this.length=this.array.length},DOMStack.prototype.reverse=function(){this.array.reverse.apply(this.array,arguments),this[0]=this.array[0]},DOMStack.prototype.indexOf=function(){return this.array.indexOf.apply(this.array,arguments)},DOMStack.prototype.every=function(){return this.array.every.apply(this.array,arguments)},DOMStack.prototype.some=function(){return this.array.some.apply(this.array,arguments)},DOMStack.prototype.unique=function(){for(var len=this.array.length,ret=[],obj={},i=0;len>i;i++){var arrayItem=JSON.stringify(this.array[i]),arrayItemValue=this.array[i];void 0===obj[arrayItem]?(ret.push(arrayItemValue),obj[arrayItem]=1):obj[arrayItem]++}this.array=ret,this[0]=this.array[0],this.length=this.array.length},DOMStack.prototype.getData=function(){return this.array},DOMStack.prototype.type=function(){return"domstack"},DOMStack.prototype.purge=function(){this.array.length=0,this.length=0},DOMStack}();self.DOMStack=DOMStack}(window),function(){"use strict";function Truck(selector,context){var __this=this,idRE=/^#([\w-]*)$/,classRE=/^\.([\w-])$/,tagRE=/^[\w-]+$/,readyRE=/complete|loaded|interactive/,slice=function(elements){return temp=new DOMStack([].slice.apply(elements)),temp[0]=temp.array[0],temp},getId=function(selector){var el=document.getElementById(selector.split("#")[1]);return el?(temp=new DOMStack([el]),temp[0]=new DOMStack([el]).array[0],temp.length=1,temp):new DOMStack},getTag=function(selector,context){return context?(temp=slice(context.getElementsByTagName(selector)),temp[0]=temp.array[0],temp.length=temp.length,temp):(temp=slice(document.getElementsByTagName(selector)),temp[0]=temp.array[0],temp.length=temp.array.length,temp)},getClass=function(selector,context){return context?(temp=slice(context.getElementsByClassName(selector.split(".")[1])),temp[0]=temp.array[0],temp.length=temp.length,temp):(temp=slice(document.getElementsByClassName(selector.split(".")[1])),temp[0]=temp.array[0],temp.length=temp.array.length,temp)},getNode=function(selector,context){return"string"==typeof selector&&(selector=selector.trim()),"string"==typeof selector&&idRE.test(selector)?getId(selector):selector&&selector instanceof Array&&selector.length?selector:context||"string"!=typeof selector?context?(temp=slice($(context).find(selector)),temp[0]=temp.array[0],temp.length=temp.array/length,temp):(temp=slice(document.querySelectorAll(selector)),temp[0]=temp.array[0],temp.length=temp.array.length,temp):/<\/?[^>]+>/.test(selector)?__this.html(selector):tagRE.test(selector)?getTag(selector):classRE.test(selector)?getClass(selector):(temp=slice(document.querySelectorAll(selector)),temp[0]=temp.array[0],temp.length=temp.array.length,temp)};if(selector&&selector.constructor.toString().match(/DOMStack/))return selector;if(selector===document)return new DOMStack(document);if(null===selector)return new DOMStack;if(context){if("string"==typeof context)return temp=slice(document.querySelectorAll(context+" "+selector)),temp[0]=temp.array[0],temp.length=temp.array.length,temp;if(1===context.nodeType)return getNode(selector,context)}else if("function"==typeof selector)readyRE.test(document.readyState)&&document.body?selector.call(selector):document.addEventListener("DOMContentLoaded",function(){return selector.call(selector)});else{if(selector&&1===selector.nodeType)return temp=new DOMStack,temp[0]=selector,temp.length=temp.array.length,temp.push(selector),temp;if("string"!=typeof selector){if(selector instanceof Array){var node;return selector.every(function(ctx){ctx.nodeType||(node="false")}),"false"===node?[]:selector}return selector===window?(temp=new DOMStack,temp[0]=window,temp.length=temp.array.length,temp):new DOMStack}if(""===selector)return new DOMStack;if(/<\/?[^>]+>/.test(selector))return Truck.html(selector);try{return getNode(selector)?getNode(selector):new DOMStack}catch(err){return new DOMStack}}return new DOMStack}if("undefined"==typeof jQuery){var temp;!function(Truck){Truck.extend=function(targetObject,sourceObject){sourceObject||(sourceObject=targetObject,targetObject=Truck);for(var keys=Object.keys(sourceObject),len=keys.length;len--;)targetObject[keys[len]]=sourceObject[keys[len]];return Truck},Truck.fn={extend:function(object){return Truck.extend(DOMStack.prototype,object)}}}(Truck),window.Truck=Truck,"undefined"==typeof jQuery&&(window.$=Truck)}}(),function(){"use strict";"undefined"==typeof jQuery&&$.extend({lib:"TruckJS",version:"1.0.0-beta.9",noop:function(){},uuid:function(){var d=Date.now(),charset="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),randomLetter=charset[Math.floor(Math.random()*charset.length)];return randomLetter+"xxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"===c?r:3&r|8).toString(16)})},html:function(HTMLString){var temp,ret=new DOMStack,wrapperMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],__default:[1,"<div>","</div>"]};wrapperMap.optgroup=wrapperMap.option,wrapperMap.tbody=wrapperMap.tfoot=wrapperMap.colgroup=wrapperMap.caption=wrapperMap.thead,wrapperMap.th=wrapperMap.td;var element=document.createElement("div"),match=/<\s*\w.*?>/g.exec(HTMLString);if(null!==match){var tag=match[0].replace(/</g,"").replace(/>/g,""),map=wrapperMap[tag]||wrapperMap.__default;HTMLString=map[1]+HTMLString+map[2],element.innerHTML=HTMLString,element=element.lastChild,temp=[].slice.apply(element.childNodes),temp.forEach(function(ctx){1===ctx.nodeType?ret.push(ctx):3===ctx.nodeType&&0!==ctx.nodeValue.trim().length&&ret.push(ctx)})}else element.innerHTML=HTMLString,element=element.lastChild,ret.push(element);return ret},require:function(src,callback,ctx){var err,loadScript,onerror="onerror",insertScript=function(script){var firstScript=document.getElementsByTagName("script")[0];firstScript.parentNode.insertBefore(script,firstScript)},script=document.createElement("script"),done=!1,handleError=function(){err=new Error(src||"EMPTY"),loadScript()},setupLoad=function(fn){return function(){done||(done=!0,fn(),callback&&callback.call(ctx,err))}};loadScript=setupLoad(function(){script.onload=script[onerror]=null}),script[onerror]=handleError,script.onload=loadScript,script.async=!0,script.charset="utf-8",script.src=src,insertScript(script)},delay:function(func,milliseconds){void 0===milliseconds&&(milliseconds=1),func=func||$.noop,setTimeout(function(){func.call(func)},milliseconds)},defer:function(func){return func=func||$.noop,$.delay.apply($,[func,1].concat([].slice.call(arguments,1)))},each:function(obj,callback){var value,key,length,i=0;if(Array.isArray(obj)){for(length=obj.length;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);return obj}if(obj.constructor.toString().match(/DOMStack/))return obj.forEach(function(item,idx){callback.call(item,idx,item)}),obj;if("object"===$.type(obj)&&Object.keys(obj).length)for(key in obj)if(callback.call(obj[key],key,obj[key])===!1)return obj},unique:function(array){if(array&&Array.isArray(array)){for(var len=array.length,obj={},ret=[],i=0;len>i;i++){var arrayItem=JSON.stringify(array[i]),arrayItemValue=array[i];void 0===obj[arrayItem]?(ret.push(arrayItemValue),obj[arrayItem]=1):obj[arrayItem]++}return ret}}})}(),function(){"use strict";"undefined"==typeof jQuery&&$.extend({type:function(type){switch(typeof type){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"function":return"function";case"object":if(Array.isArray(type))return"array";if("[object Date]"===Object.prototype.toString.call(type))return"date";if("[object Error]"===Object.prototype.toString.call(type))return"error";if("[object RegExp]"===Object.prototype.toString.call(type))return"regexp";if("[object Object]"===Object.prototype.toString.call(type))return"object"}}})}(),function(){"use strict";"undefined"==typeof jQuery&&$.extend({camelize:function(string){return"string"==typeof string?string.replace(/\-(.)/g,function(match,letter){return letter.toUpperCase()}):void 0},deCamelize:function(string){return"string"==typeof string?string.replace(/([A-Z])/g,"-$1").toLowerCase():void 0},capitalize:function(string,all){var $this=this;if(string&&"string"==typeof string){if(all){var str=string.split(" "),newstr=[];return str.forEach(function(item){return newstr.push($this.capitalize(item))}),newstr.join(" ")}return string.charAt(0).toUpperCase()+string.substring(1).toLowerCase()}},w:function(str){return str.split(" ")}})}(),function(){"use strict";if("undefined"==typeof jQuery){var slice=function(elements){return new DOMStack([].slice.apply(elements))};$.fn.extend({find:function(selector,context){var ret=new DOMStack;return this.size()?(context?$(context).forEach(function(){slice(context.querySelectorAll(selector)).forEach(function(node){return ret.push(node)})}):this.forEach(function(ctx){ctx&&ctx.children&&ctx.children.length&&slice(ctx.querySelectorAll(selector)).forEach(function(node){return ret.push(node)})}),ret):ret},is:function(arg){var ret=!1;if(this.size()&&arg&&this.size()){var that=this,__is=function(node,arg){if("string"==typeof arg){var elements=Array.prototype.slice.apply(node.parentNode.querySelectorAll(arg));elements.length&&elements.indexOf(node)>=0&&(ret=!0)}else if("function"==typeof arg)arg.call(that)&&(ret=!0);else if(arg.constructor.toString().match(/DOMStack/))node===arg[0]&&(ret=!0);else if(arg&&arg.length)-1!==this.slice.apply(arg).indexOf(node)&&(ret=!0);else{if(1!==arg.nodeType)return;node===arg&&(ret=!0)}return ret};return this.forEach(function(item){__is(item,arg)&&(ret=!0)}),ret}},not:function(selector){if(!this.size()||!selector)return new DOMStack;var elems,ret=new DOMStack,temp=[];return"string"==typeof selector?(elems=Array.prototype.slice.apply(this.array[0].parentNode.querySelectorAll(selector)),this.forEach(function(element){elems.forEach(function(item){element!==item&&ret.push(element)})}),ret):selector&&selector.constructor.toString().match(/DOMStack/)?(this.forEach(function(element){selector.forEach(function(node){node!==element&&temp.push(element)})}),temp.length&&ret.concat(temp),ret):selector&&1===selector.nodeType?(this.forEach(function(element){element!==selector&&temp.push(element)}),temp.length&&ret.concat(temp),ret):void 0},has:function(arg){if(!this.size())return new DOMStack;var items=new DOMStack,__has=function(node,arg){if("string"==typeof arg){if(node.querySelector(arg))return!0}else{if(1!==arg.nodeType)return!1;if(slice(this.children).data.indexOf(arg))return!0}};return this.forEach(function(element){__has(element,arg)&&items.push(element)}),items},prev:function(selector){if(!this.size())return new DOMStack;var children,ret=new DOMStack,prevElement=this[0].previousElementSibling;return selector&&"string"==typeof selector?(children=this.siblings(selector),children.forEach(function(element){prevElement===element&&ret.push(element)})):ret.push(this[0].previousElementSibling),ret},prevAll:function(selector){if(!this.size())return new DOMStack;var __siblings,ret=new DOMStack,__self=this[0],__sibs=Array.prototype.slice.apply(this[0].parentNode.children),pos=__sibs.indexOf(__self);return __sibs.splice(pos,__sibs.length-1),selector&&"string"==typeof selector?(__siblings=this.siblings(selector).array,__sibs.forEach(function(element){__siblings.indexOf(element)>-1&&ret.push(element)})):(__siblings=Array.prototype.slice.apply(this[0].parentNode.children),pos=__siblings.indexOf(__self),__siblings.splice(pos,__siblings.length-1),ret.concat(__siblings)),ret},next:function(selector){if(!this.size())return new DOMStack;var children,ret=new DOMStack,nextElement=this[0].nextElementSibling;return selector&&"string"==typeof selector?(children=this.siblings(selector),children.forEach(function(element){nextElement===element&&ret.push(element)})):ret.push(this[0].nextElementSibling),ret},nextAll:function(selector){if(!this.size())return new DOMStack;var __siblings,_parent,ret=new DOMStack,__self=this[0],__sibs=Array.prototype.slice.apply(this[0].parentNode.children),pos=__sibs.indexOf(__self);return __sibs.splice(0,pos+1),selector&&"string"==typeof selector?(_parent=this.array[0].parentNode,__siblings=$(_parent).find(selector),__sibs.splice(0,__sibs.indexOf(this.array[0])),__sibs.forEach(function(element){__siblings.array.indexOf(element)>-1&&ret.push(element)})):(__siblings=Array.prototype.slice.apply(this[0].parentNode.children),pos=__siblings.indexOf(__self),__siblings.splice(0,pos+1),ret.concat(__siblings)),ret},first:function(){return this.size()?this.eq(0):new DOMStack},last:function(){return this.size()?this.eq(-1):new DOMStack},index:function(element){return this.size()?element?element&&element.constructor.toString().match(/DOMStack/)?this.indexOf(element.getData()[0]):1===element.nodeType?this.indexOf(element):this.indexOf(element):[].slice.apply(this[0].parentNode.children).indexOf(this[0]):void 0},children:function(selector){if(!this.size())return new DOMStack;var ret=new DOMStack;return selector?(this.forEach(function(node){slice(node.children).forEach(function(ctx){$(ctx).is(selector)&&ret.push(ctx)})}),ret[0]=ret.array[0]):(this.forEach(function(node){slice(node.children).forEach(function(ctx){return ret.push(ctx)})}),ret[0]=ret.array[0]),ret},siblings:function(selector){if(!this.size())return new DOMStack;var __siblings,parent,ret=new DOMStack,$this=this,children=Array.prototype.slice.apply(this.array[0].parentNode.children),pos=children.indexOf($this[0]);return children.splice(pos,1),children.splice(children.indexOf(this.array[0]),0),selector&&"string"==typeof selector?(parent=this.array[0].parentNode,__siblings=$(parent).find(selector),__siblings.array.splice(__siblings.array.indexOf(this.array[0]),0),ret.concat(__siblings.array)):ret.concat(children),ret},parent:function(){if(!this.size())return new DOMStack;var ret=new DOMStack;return this.forEach(function(ctx){return ret.push(ctx.parentNode)}),ret.unique(),ret},closest:function(selector){if(!this.size())return new DOMStack;var ret=new DOMStack;if("undefined"==typeof selector)return new DOMStack;var position=null,p=this[0].parentNode;if(!p)return new DOMStack;if("string"==typeof selector&&selector.trim(),"number"==typeof selector){position=selector||1;for(var i=1;position>i;i++){if(p&&"HTML"===p.nodeName)return p;null!==p&&(p=p.parentNode)}ret.push(p)}else"string"==typeof selector&&(p&&$(p).is(selector)?ret.push(p):ret.push($(p).closest(selector).array[0]));return ret},css:function(property,value){if(!this.size())return new DOMStack;var pixelRE=/top|bottom|left|right|margin|padding/gim,postFix="",ret=new DOMStack,testForPixelSupport=function(value,property){"number"===$.type(value)&&property.match(pixelRE)&&(postFix="px")};if(!property)return new DOMStack;if(value||"object"!==$.type(property)){if(!value&&"string"==typeof property){if(!this.size())return;return document.defaultView.getComputedStyle(this.eq(0).array[0],null).getPropertyValue(property.toLowerCase())}value&&this.forEach(function(node){testForPixelSupport(value,property),node.style[$.camelize(property)]=value+postFix,ret.push(node)})}else this.forEach(function(node){for(var key in property)property.hasOwnProperty(key)&&(testForPixelSupport(property[key],key),node.style[$.camelize(key)]=property[key]+postFix);ret.push(node)});return ret},width:function(){return this.size()?this.eq(0).array[0].clientWidth:void 0},height:function(){return this.size()?this.eq(0).array[0].clientHeight:void 0},before:function(content){if(!this.size())return new DOMStack;var __before=function(node,content){if(("string"==typeof content||"number"==typeof content)&&(content=$.html(content)),content&&content.constructor.toString().match(/DOMStack/))for(var len=content.size(),i=0;len>i;)node.parentNode.insertBefore(content.array[i],node),i++;else content&&1===content.nodeType&&node.parentNode.insertBefore(content,node);return this};return this.forEach(function(node){return __before(node,content)}),this},after:function(args){if(!this.size())return new DOMStack;var __after=function(node,content){var parent=node.parentNode;if(("string"==typeof content||"number"==typeof content)&&(content=$.html(content)),content&&content.constructor.toString().match(/DOMStack/))for(var i=0,len=content.size();len>i;)node===parent.lastChild?parent.appendChild(content.array[i]):parent.insertBefore(content.array[i],node.nextSibling),i++;else content&&1===content.nodeType&&parent.appendChild(content);return this};return this.forEach(function(node){return __after(node,args)}),this},prepend:function(content){return this.size()?("string"==typeof content||"number"==typeof content?this.forEach(function(element){element.insertAdjacentHTML("afterbegin",content)}):content&&content.constructor.toString().match(/DOMStack/)?this.forEach(function(element){content.forEach(function(node){element.insertBefore(node,element.firstChild)})}):content&&1===content.nodeType&&this.forEach(function(element){element.insertBefore(node,element.firstChild)}),this):new DOMStack},append:function(content){return this.size()?("string"==typeof content||"number"==typeof content?this.forEach(function(element){element.insertAdjacentHTML("beforeend",content)}):content&&content.constructor.toString().match(/DOMStack/)?this.forEach(function(element){content.forEach(function(node){element.insertBefore(node,null)})}):content&&1===content.nodeType&&this.forEach(function(element){element.insertBefore(node,null)}),this):new DOMStack},prependTo:function(selector){return this.size()?(this.reverse(),this.forEach(function(item){return $(selector).prepend(item)}),this):new DOMStack},appendTo:function(selector){return this.size()?(this.forEach(function(item){return $(selector).append(item)}),this):new DOMStack},clone:function(value){if(!this.size())return new DOMStack;var ret=new DOMStack;return this.forEach(function(ctx){value!==!0&&value?ret.push(ctx.cloneNode(!1)):ret.push(ctx.cloneNode(!0))}),ret},wrap:function(string){if(!this.size()||!string)return new DOMStack;var tempNode,empNode,whichClone;this.forEach(function(ctx){tempNode=$.html(string),empNode=tempNode.array[0],whichClone=$(ctx).clone(!0),tempNode.append(whichClone),$(ctx).before(tempNode),$(ctx).remove()})},unwrap:function(){if(!this.size())return new DOMStack;var parentNode=null;this.forEach(function(node){return node.parentNode!==parentNode?(parentNode=node.parentNode,"BODY"===node.parentNode.nodeName?!1:void $.replace(node,node.parentNode)):void 0})},offset:function(){if(this.size()){var offset=this.eq(0).array[0].getBoundingClientRect();return{top:Math.round(offset.top),left:Math.round(offset.left)}}},position:function(){var obj={top:0,left:0},pos=this.array[0].getBoundingClientRect(),borderTop=parseInt(this.parent().css("border-top-width"),10)||0,borderLeft=parseInt(this.parent().css("border-left-width"),10)||0,parentPos=this.array[0].parentNode.getBoundingClientRect(),compareOffsets1=function(val1,val2){return Math.round(val1-val2)};return obj.top=compareOffsets1(pos.top,parentPos.top+borderTop),obj.left=compareOffsets1(pos.left,parentPos.left+borderLeft),obj},empty:function(){if(!this.size())return new DOMStack;var ret=new DOMStack;return this.forEach(function(ctx){ctx.textContent="",ret.push(ctx)}),ret},html:function(content){return this.size()?""===content?(this.forEach(function(node){node.innerHTML=""}),this):content?(this.forEach(function(node){node.innerHTML=content}),this):content?void 0:this.array[0].innerHTML.trim():new DOMStack},text:function(string){var ret="";return this.size()?string||0===string?(this.forEach(function(element){element.innerText=string}),this):(this.forEach(function(element){ret+=element.innerText,ret.trim()}),ret):new DOMStack},replaceWith:function(content){content&&content.nodeType&&1===content.nodeType?$(content).off():content.constructor.toString().match(/DOMStack/)&&content.off(),this.forEach(function(node){$(node).off(),"string"==typeof content?$.replace($(content),node):$.replace($(content),node)})},remove:function(){return this.size()?void this.forEach(function(node){$(node).off(),node.parentNode.removeChild(node)}):new DOMStack},addClass:function(className){if(!this.size())return new DOMStack;if("string"==typeof className){var classes,ret=new DOMStack;return this.forEach(function(node){/\s/.test(className)?(classes=className.split(" "),classes.forEach(function(name){node.classList.add(name)})):node.classList.add(className),ret.push(node)}),ret}},hasClass:function(className){if(!this.size())return new DOMStack;var temp=!1;return this.forEach(function(element){element.classList.contains(className)&&(temp=!0)}),temp},removeClass:function(className){if(!this.size())return new DOMStack;var classes,ret=new DOMStack;return this.forEach(function(node){node&&(/\s/.test(className)?(classes=className.split(" "),classes.forEach(function(name){node.classList.remove(name)})):node.classList.remove(className),""===node.getAttribute("class")&&node.removeAttribute("class"),ret.push(node))}),ret},toggleClass:function(className){if(!this.size())return new DOMStack;var ret=new DOMStack;return this.forEach(function(node){node.classList.toggle(className),ret.push(node)}),ret},attr:function(property,value){if(!this.size())return new DOMStack;var ret=new DOMStack,__attr=function(node,property,value){return void 0===value?node.getAttribute(property):node.setAttribute(property,value)};if(void 0===value){if(this[0].hasAttribute(property))return this[0].getAttribute(property)}else this.forEach(function(node){__attr(node,property,value),ret.push(node)});return ret.length?ret:void 0},removeAttr:function(attribute){if(!this.size())return new DOMStack;var ret=new DOMStack;return this.forEach(function(node){node.hasAttribute(attribute)&&(node.removeAttribute(attribute),ret.push(node))}),ret},prop:function(property,value){return this.size()?value===!1||value?(this.forEach(function(element){element[property]=value}),this):this.array[0]&&this.array[0][property]?this.array[0][property]:void 0:new DOMStack},removeProp:function(property){return this.size()?(this[0][property]=!1,[this[0]]):new DOMStack},disable:function(){return this.size()?(this.forEach(function(node){node.classList.add("disabled"),node.disabled=!0,node.style.cursor="default"}),this):new DOMStack},enable:function(){return this.size()?(this.forEach(function(node){node.classList.remove("disabled"),node.removeAttribute("disabled"),node.style.cursor="auto"}),this):new DOMStack},val:function(value){return this.size()?value?(this.array[0].value=value,this):this.array[0]&&this.array[0].value?this.array[0].value:void 0:new DOMStack},hide:function(){var display=this.css("display");this.data("display_attr",display),this.css("display","none")},show:function(){var display=this.data("display_attr");"none"!==display&&display||(display="block"),this.css("display",display)}})}}(),function(){"use strict";if("undefined"==typeof jQuery){var TruckDataCache={elements:{}};$.fn.extend({data:function(key,value){if(!this.size())return new DOMStack;var val,id,ctx=this.array[0];if(ctx.id||(ctx.id=$.uuid()),id=ctx.id,TruckDataCache.elements[id]||(TruckDataCache.elements[id]={}),"undefined"!==key&&null!==key){if(!value&&0!==value){if(!TruckDataCache.elements[id])return;if(0===TruckDataCache.elements[id][key])return TruckDataCache.elements[id][key];if(!TruckDataCache.elements[id][key])return;return TruckDataCache.elements[id][key]}val=value;var obj={};return obj[key]=value,TruckDataCache.elements[id][key]=value,this}},removeData:function(key){return this.size()?void this.forEach(function(element){var id=element.id;return id&&TruckDataCache.elements[id]?key?(0===Object.keys(TruckDataCache.elements[id]).length?delete TruckDataCache.elements[id]:delete TruckDataCache.elements[id][key],this):(delete TruckDataCache.elements[id],this):this}):this}})}}(),function(){"use strict";function serialize(params,obj,traditional,scope){var type,array="array"===$.type(obj),hash=$.isEmptyObject(obj);if("array"===$.type(obj))$.each(obj,function(key,value){type=$.type(value),scope&&(key=traditional?scope:scope+"["+(hash||"object"==type||"array"==type?key:"")+"]"),!scope&&array?params.add(value.name,value.value):"array"==type||!traditional&&"object"==type?serialize(params,value,traditional,key):params.add(key,value)});else if("object"===$.type(obj))for(var key in obj)type=$.type(obj[key]),scope&&(key=traditional?scope:scope+"["+(hash||"object"==type||"array"==type?key:"")+"]"),!scope&&array?params.add(obj[key].name,obj[key].obj[key]):"array"==type||!traditional&&"object"==type?serialize(params,obj[key],traditional,key):params.add(key,obj[key])}"undefined"==typeof jQuery&&($.fn.extend({serializeArray:function(){var name,type,ret=[],add=function(value){return"array"===$.type(value)?value.forEach(add):void ret.push({name:name,value:value})};return this[0]&&$.each([].slice.apply(this[0].elements),function(_,field){type=field.type,name=field.name,name&&"fieldset"!=field.nodeName.toLowerCase()&&!field.disabled&&"submit"!=type&&"reset"!=type&&"button"!=type&&"file"!=type&&("radio"!=type&&"checkbox"!=type||field.checked)&&add($(field).val())}),ret},serialize:function(){var ret=[];return this.serializeArray().forEach(function(element){ret.push(encodeURIComponent(element.name)+"="+encodeURIComponent(element.value))}),ret.join("&")}}),$.extend({param:function(obj,traditional){var params=[];return params.add=function(key,value){"function"===$.type(value)&&(value=value()),null===value&&(value=""),this.push(encodeURIComponent(key)+"="+encodeURIComponent(value))},serialize(params,obj,traditional),params.join("&").replace(/%20/g,"+")}}))}(),function(){"use strict";if("undefined"==typeof jQuery){var TruckEventStack=function(array){var __array=[];if(array&&Array.isArray(array))for(var i=-1,len=array.length;++i<len;)__array[i]=array[i];else if(array){var arr=Array.prototype.slice.apply(arguments);arr.forEach(function(ctx,idx){__array[idx]=ctx})}return{size:function(){return __array.length},push:function(data){__array.push(data)},pop:function(){return __array.pop()},eq:function(index){return 0>index?__array[__array.length+index]:__array[index]},forEach:function(callback){for(var value,i=-1,len=__array.length;++i<len&&(value=callback.call(__array[i],__array[i],i),value!==!1););},shift:function(){return __array.shift.apply(__array,arguments)},unshift:function(){__array.unshift.apply(__array,arguments)},splice:function(){__array.splice.apply(__array,arguments)},indexOf:function(){return __array.indexOf.apply(__array,arguments)},getData:function(){return __array},purge:function(){__array=[]}}},TruckEventCache={elements:{}},bind=function(element,event,callback,capturePhase){element.id||(element.id=Truck.uuid()),TruckEventCache.elements[element.id]||(TruckEventCache.elements[element.id]=TruckEventStack()),TruckEventCache.elements[element.id].push({event:event,callback:callback}),element.addEventListener(event,callback,capturePhase)},deleteFromEventStack=function(toDelete,evtStck){for(var len=toDelete.length,i=0;len>i;len--)evtStck.splice(toDelete[len-1],1)},unbind=function(element,event,callback,capturePhase){var eventStack=TruckEventCache.elements[element.id];if(eventStack){var deleteOrder=[];event?event&&!callback?(deleteOrder=[],eventStack.forEach(function(evt,idx){evt.event===event&&(element.removeEventListener(evt.event,evt.callback,evt.capturePhase),deleteOrder.push(idx))}),deleteFromEventStack(deleteOrder,eventStack)):callback&&(deleteOrder=[],eventStack.forEach(function(evt,idx){callback===evt.callback&&(element.removeEventListener(evt.event,evt.callback,evt.capturePhase),deleteOrder.push(idx))}),deleteFromEventStack(deleteOrder,eventStack)):(deleteOrder=[],eventStack.forEach(function(evt,idx){element.removeEventListener(evt.event,evt.callback,evt.capturePhase),deleteOrder.push(idx)}),deleteFromEventStack(deleteOrder,eventStack))}},delegate=function(element,selector,event,callback,capturePhase){$(element).array[0];$(element).forEach(function(ctx){$(ctx).on(event,function(e){var target=e.target;3===e.target.nodeType&&(target=e.target.parentNode),$(ctx).find(selector).forEach(function(delegateElement){if(delegateElement===target)callback.call(delegateElement,e);else try{var ancestor=$(target).closest(selector);delegateElement===ancestor.array[0]&&callback.call(delegateElement,e)}catch(err){}})},capturePhase)})},undelegate=function(element,selector,event,callback,capturePhase){unbind($(element).array[0],event,callback,capturePhase);
};Truck.fn.extend({on:function(event,selector,callback,capturePhase){!selector&&/Object/gim.test(event.constructor.toString())&&this.forEach(function(element){for(var key in event)event.hasOwnProperty(key)&&$(element).on(key,event[key])});var events,ret=[];return"string"==typeof event&&(event=event.trim(),/\s/.test(event)&&(events=event.split(" "),this.forEach(function(ctx){events.forEach(function(evt){"function"==typeof selector?(bind(ctx,evt,selector,callback),ret.push(ctx)):delegate(ctx,selector,evt,callback,capturePhase)})}))),this.forEach(function(ctx){return"function"==typeof selector?bind(ctx,event,selector,callback):void delegate(ctx,selector,event,callback,capturePhase)}),this},off:function(event,selector,callback,capturePhase){var ret=new DOMStack;return this.size()?void this.forEach(function(ctx){return"undefined"==typeof event?(ret.push(ctx),unbind(ctx),ret):"function"!=typeof selector&&selector?(undelegate(ctx,selector,event,callback,capturePhase),this):(unbind(ctx,event,selector,callback,capturePhase),this)}):ret},trigger:function(event){return this.size()?void this.forEach(function(ctx){if(document.createEvent){var evtObj=document.createEvent("Events");evtObj.initEvent(event,!0,!1),ctx.dispatchEvent(evtObj)}}):new DOMStack}})}}(),function(){"use strict";$.extend({isiPhone:/iphone/gim.test(navigator.userAgent),isiPad:/ipad/gim.test(navigator.userAgent),isiPod:/ipod/gim.test(navigator.userAgent),isiOS:/ip(hone|od|ad)/gim.test(navigator.userAgent),isAndroid:/android/gim.test(navigator.userAgent)&&!/trident/gim.test(navigator.userAgent),isBlackberry:/blackberry/gim.test(navigator.userAgent),isTouchEnabled:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&"createTouch"in document,isOnline:navigator.onLine,isStandalone:navigator.standalone,isWin:/edge/gim.test(navigator.userAgent)||/trident/gim.test(navigator.userAgent),isIE10:/msie 10/gim.test(navigator.userAgent),isIE11:/windows nt/gim.test(navigator.userAgent)&&/trident/gim.test(navigator.userAgent),isWebkit:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/webkit/gim.test(navigator.userAgent),isDesktop:!/mobile/gim.test(navigator.userAgent),isSafari:!/edge/gim.test(navigator.userAgent)&&!/Chrome/gim.test(navigator.userAgent)&&/Safari/gim.test(navigator.userAgent)&&!/android/gim.test(navigator.userAgent),isChrome:!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/Chrome/gim.test(navigator.userAgent)&&!((/samsung/gim.test(navigator.userAgent)||/Galaxy Nexus/gim.test(navigator.userAgent)||/HTC/gim.test(navigator.userAgent)||/LG/gim.test(navigator.userAgent))&&!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent)),isNativeAndroid:(/samsung/gim.test(navigator.userAgent)||/Galaxy Nexus/gim.test(navigator.userAgent)||/HTC/gim.test(navigator.userAgent)||/LG/gim.test(navigator.userAgent))&&!/trident/gim.test(navigator.userAgent)&&!/edge/gim.test(navigator.userAgent)&&/android/i.test(navigator.userAgent)&&/webkit/i.test(navigator.userAgent)})}(),function(){"use strict";$.extend({eventStart:null,eventEnd:null,eventMove:null,eventCancel:null,gestureLength:30}),$(function(){window.navigator.pointerEnabled?($.eventStart="pointerdown",$.eventEnd="pointerup",$.eventMove="pointermove",$.eventCancel="pointercancel"):window.navigator.msPointerEnabled?($.eventStart="MSPointerDown",$.eventEnd="MSPointerUp",$.eventMove="MSPointerMove",$.eventCancel="MSPointerCancel"):"ontouchstart"in window&&/mobile/gim.test(navigator.userAgent)?($.eventStart="touchstart",$.eventEnd="touchend",$.eventMove="touchmove",$.eventCancel="touchcancel"):($.eventStart="mousedown",$.eventEnd="click",$.eventMove="mousemove",$.eventCancel="mouseout")})}(),function(){"use strict";function parentIfText(node){return"tagName"in node?node:node.parentNode}function swipeDirection(x1,x2,y1,y2){return Math.abs(x1-x2)>=Math.abs(y1-y2)?x1-x2>0?"left":"right":y1-y2>0?"up":"down"}function longTap(){if(longTapTimeout=null,touch.last)try{touch&&touch.el&&(touch.el.trigger("longtap"),touch={})}catch(err){}}function cancelLongTap(){longTapTimeout&&clearTimeout(longTapTimeout),longTapTimeout=null}function cancelAll(){touchTimeout&&clearTimeout(touchTimeout),tapTimeout&&clearTimeout(tapTimeout),swipeTimeout&&clearTimeout(swipeTimeout),longTapTimeout&&clearTimeout(longTapTimeout),touchTimeout=tapTimeout=swipeTimeout=longTapTimeout=null,touch={}}var touchTimeout,swipeTimeout,tapTimeout,touch={},longTapDelay=750,singleTapDelay=150;$.gestureLength=50,$.isAndroid&&(singleTapDelay=200);var longTapTimeout;$(function(){var now,delta,body=$("body"),twoTouches=!1;body.on($.eventStart,function(e){if(now=Date.now(),delta=now-(touch.last||now),e.originalEvent&&(e=e.originalEvent),window.navigator.pointerEnabled||window.navigator.msPointerEnabled){if(window&&window.jQuery&&$===window.jQuery){if(e.originalEvent&&!e.originalEvent.isPrimary)return}else if(!e.isPrimary)return;e=e.originalEvent?e.originalEvent:e,body.on("MSHoldVisual",function(e){e.preventDefault()}),touch.el=$(parentIfText(e.target)),touchTimeout&&clearTimeout(touchTimeout),touch.x1=e.pageX,touch.y1=e.pageY,twoTouches=!1}else"mousedown"===$.eventStart?(touch.el=$(parentIfText(e.target)),touchTimeout&&clearTimeout(touchTimeout),touch.x1=e.pageX,touch.y1=e.pageY,twoTouches=!1):1===e.touches.length&&(touch.el=$(parentIfText(e.touches[0].target)),touchTimeout&&clearTimeout(touchTimeout),touch.x1=e.touches[0].pageX,touch.y1=e.touches[0].pageY,twoTouches=2===e.targetTouches.length?!0:!1);delta>0&&250>=delta&&(touch.isDoubleTap=!0),touch.last=now,longTapTimeout=setTimeout(longTap,longTapDelay)}),body.on($.eventMove,function(e){if(e.originalEvent&&(e=e.originalEvent),window.navigator.pointerEnabled||window.navigator.msPointerEnabled){if(window&&window.jQuery&&$===window.jQuery){if(e.originalEvent&&!e.originalEvent.isPrimary)return}else if(!e.isPrimary)return;e=e.originalEvent?e.originalEvent:e,cancelLongTap(),touch.x2=e.pageX,touch.y2=e.pageY}else cancelLongTap(),"mousemove"===$.eventMove?(touch.x2=e.pageX,touch.y2=e.pageY):1===e.touches.length&&(touch.x2=e.touches[0].pageX,touch.y2=e.touches[0].pageY)}),body.on($.eventEnd,function(e){if(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)if(window&&window.jQuery&&$===window.jQuery){if(e.originalEvent&&!e.originalEvent.isPrimary)return}else if(!e.isPrimary)return;cancelLongTap(),touch.el&&(touch.x2&&Math.abs(touch.x1-touch.x2)>$.gestureLength||touch.y2&&Math.abs(touch.y1-touch.y2)>$.gestureLength?swipeTimeout=setTimeout(function(){touch&&touch.el&&(touch.el.trigger("swipe"),touch.el.trigger("swipe"+swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2)),touch={})},0):"last"in touch&&(tapTimeout=setTimeout(function(){touch&&touch.isDoubleTap?touch&&touch.el&&(touch.el.trigger("doubletap"),touch={}):touchTimeout=setTimeout(function(){return touchTimeout=null,touch&&touch.el?(touch.el.trigger("tap"),touch={},!1):void 0},singleTapDelay)},0)))}),body.on("touchcancel",cancelAll)}),["tap","doubletap","longtap","swipeleft","swiperight","swipeup","swipedown"].forEach(function(method){$.fn.extend({method:function(callback){return this.on(method,callback)}})})}(),function(){"use strict";$.extend({replace:function(newElement,targetElement){if(newElement&&targetElement){var newEl,targEl;"string"==typeof newElement?newEl=$(newElement)[0]:newElement.constructor.toString().match(/DOMStack/)?newEl=newElement[0]:1===newElement.nodeType&&(newEl=newElement),"string"==typeof targetElement?targEl=$(targetElement)[0]:targetElement.constructor.toString().match(/DOMStack/)?targEl=targetElement[0]:1===targetElement.nodeType&&(targEl=targetElement),$(targEl).off(),targEl.parentNode.replaceChild(newEl,targEl)}},isEmptyObject:function(obj){return 0===Object.keys(obj).length},isInteger:function(number){return"number"==typeof number&&number%1===0},isFloat:function(number){return"number"==typeof number&&number%1!==0},encode:function(value){return encodeURIComponent(value)},escapeHTML:function(data){var tagsToReplace={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"},str=JSON.stringify(data),replaceTag=function(tag){return tagsToReplace[tag]||tag},safe_tags_replace=function(str){return str.replace(/[&<>]/g,replaceTag)};return str=safe_tags_replace(str),JSON.parse(str)},concat:function(args){return args instanceof Array?args.join(""):[].slice.apply(arguments).join("")}}),"function"!=typeof $.uuid&&$.extend({uuid:function(){var d=Date.now(),charset="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),randomLetter=charset[Math.floor(Math.random()*charset.length)];return randomLetter+"xxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"===c?r:3&r|8).toString(16)})}}),$.fn.extend({iz:function(selector){var ret=$();return this.forEach(function(ctx){$(ctx).is(selector)&&ret.push(ctx)}),ret},iznt:function(selector){var ret=$();return this.each(function(_,ctx){$(ctx).is(selector)||ret.push(ctx)}),ret},haz:function(selector){var ret;return"undefined"!=typeof jQuery?ret=this.has(selector):(ret=new DOMStack,this.forEach(function(element){$(element).has(selector)[0]&&ret.push(element)})),ret},haznt:function(selector){var ret;return"undefined"!=typeof jQuery?(ret=$(),this.each(function(_,element){$(element).has(selector)[0]||ret.push(element)})):(ret=new DOMStack,this.forEach(function(element){$(element).has(selector)[0]||ret.push(element)})),ret},hazClass:function(className){return className?this.iz("."+className):new DOMStack},hazntClass:function(className){return className?this.iznt("."+className):new DOMStack},hazAttr:function(attribute){return attribute?this.iz("["+attribute+"]"):new DOMStack},hazntAttr:function(attribute){return attribute?this.iznt("["+attribute+"]"):new DOMStack}}),"undefined"!=typeof jQuery&&$.fn.extend({forEach:function(callback){this.each(function(idx,ctx){callback.call(ctx,ctx,idx)})},disable:function(){return this.size()?(this.forEach(function(node){node.classList.add("disabled"),node.disabled=!0,node.style.cursor="default"}),this):$()},enable:function(){return this.size()?(this.forEach(function(node){node.classList.remove("disabled"),node.removeAttribute("disabled"),node.style.cursor="auto"}),this):$()}})}(),function(){"use strict";$.extend({Stack:function(array){var __array=[];if(array&&Array.isArray(array))for(var i=-1,len=array.length;++i<len;)__array[i]=array[i];else if(array){var arr=Array.prototype.slice.apply(arguments);arr.forEach(function(ctx,idx){__array[idx]=ctx})}return{size:function(){return __array.length},push:function(data){__array.push(data)},pop:function(){return __array.pop()},eq:function(index){return 0>index?__array[__array.length+index]:__array[index]},forEach:function(callback){for(var value,i=0,len=__array.length;len>i&&(value=callback.call(__array[i],__array[i],i),value!==!1);i++);},each:function(callback){for(var value,i=0,len=__array.length;len>i&&(value=callback.call(__array[i],i,__array[i]),value!==!1);i++);},shift:function(){return __array.shift.apply(__array,arguments)},unshift:function(){__array.unshift.apply(__array,arguments)},slice:function(){return __array.slice.apply(__array,arguments)},splice:function(){__array.splice.apply(__array,arguments)},sort:function(){__array.sort(arguments)},sortBy:function(args){var __orderBy=function(args){var props=arguments;return function(a,b){for(var sortByProperty=function(property){var sortOrder=1;return"-"===property[0]&&(sortOrder=-1,property=property.substr(1)),function(a,b){var result=a[property]<b[property]?-1:a[property]>b[property]?1:0;return result*sortOrder}},i=0,result=0,numberOfProperties=props.length;0===result&&numberOfProperties>i;)result=sortByProperty(props[i])(a,b),i++;return result}};__array.sort(__orderBy.apply(null,arguments))},filter:function(){return __array.filter.apply(__array,arguments)},map:function(){return __array.map.apply(__array,arguments)},join:function(separator){return __array.join(separator)},concat:function(object){if(Array.isArray(object))for(var i=-1,len=object.length;++i<len;)__array[__array.length]=object[i]},reverse:function(){__array.reverse.apply(__array,arguments)},indexOf:function(){return __array.indexOf.apply(this.array,arguments)},every:function(){return __array.every.apply(__array,arguments)},some:function(){return __array.some.apply(__array,arguments)},unique:function(){var len=__array.length,ret=[],obj={};for(i=0;len>i;i++){var arrayItem=JSON.stringify(__array[i]),arrayItemValue=__array[i];void 0===obj[arrayItem]?(ret.push(arrayItemValue),obj[arrayItem]=1):obj[arrayItem]++}__array=ret},purge:function(){__array=[]},getData:function(){return __array}}}})}(),function(){"use strict";$.extend({MediatorStack:function(array){var __array=[];if(array&&Array.isArray(array))for(var i=-1,len=array.length;++i<len;)__array[i]=array[i];else if(array){var arr=Array.prototype.slice.apply(arguments);arr.forEach(function(ctx,idx){__array[idx]=ctx})}return{size:function(){return __array.length},push:function(data){__array.push(data)},eq:function(index){return 0>index?__array[__array.length+index]:__array[index]},indexOf:function(){return __array.indexOf.apply(__array,arguments)},forEach:function(callback){for(var value,i=-1,len=__array.length;++i<len&&(value=callback.call(__array[i],__array[i],i),value!==!1););},setExecutable:function(token,exec){__array.forEach(function(receiver){receiver.token===token&&(receiver.exec=exec,delete receiver.stopAfter)})},setStopAfter:function(token,stopAfter){__array.forEach(function(receiver){receiver.token===token&&(receiver.stopAfter=stopAfter)})},splice:function(){return __array.splice.apply(__array,arguments)},getData:function(){return __array}}},mediators:{},Mediator:function(handle,callback){$.mediators[handle]||($.mediators[handle]=$.MediatorStack());var __stopAfter,__exec=!0,token=$.uuid();return $.mediators[handle].push({token:token,callback:callback,exec:!0}),{token:token,handle:handle,count:0,exec:__exec,run:function(data){this.exec&&(__stopAfter&&__stopAfter>0?(callback.call(this,data),__stopAfter--,this.stopCount||this.count++,$.mediators[handle].setStopAfter(token,__stopAfter),0===__stopAfter&&(this.exec=!1,$.mediators[handle].setExecutable(token,!1))):callback&&(callback.call(this,data),this.stopCount||this.count++))},stop:function(stopAfter){stopAfter?(__stopAfter=stopAfter,$.mediators[handle].setStopAfter(token,stopAfter)):(this.exec=!1,$.mediators[handle].setExecutable(token,!1))},start:function(){__exec=!0,$.mediators[handle].setExecutable(token,!0)}}},receive:function(handle,callback){return $.Mediator(handle,callback)},dispatch:function(handle,args){return $.mediators[handle]?(setTimeout(function(){for(var len=$.mediators[handle]?$.mediators[handle].size():0;len--;){if(!$.mediators[handle].eq(len).exec)return;var stopAfter=$.mediators[handle].eq(len).stopAfter;if(stopAfter>0)$.mediators[handle].eq(len).callback(args),stopAfter--,$.mediators[handle].setStopAfter($.mediators[handle].eq(len).token,stopAfter),0===stopAfter&&($.mediators[handle].eq(len).exec=!1);else{if(0===stopAfter)return;void 0===stopAfter&&$.mediators[handle].eq(len).callback(args)}}return!0}),!0):!1},startDispatch:function(mediator){setTimeout(function(){for(var m in $.mediators)$.mediators[m]&&$.mediators[m].size()&&$.mediators[m].forEach(function(item,i){item.token===mediator.token&&(item.exec=!0)});return!1})},stopDispatch:function(mediator){setTimeout(function(){for(var m in $.mediators)$.mediators[m]&&$.mediators[m].size()&&$.mediators[m].forEach(function(item,i){item.token===mediator.token&&(item.exec=!1)});return!1})}})}(),function(){"use strict";$.extend({Model:function(data,handle){var __handle=handle||$.uuid(),__data=data||"";data=null;var __name,__boxName,__key,__lastBoxTime,__autobox=!1,__lastModifiedTime=0,checkPublicationName=function(__handle){return"string"==typeof __handle},propagateDataLoop=function(handle,data){$.mediators[handle]&&$.mediators[handle].forEach(function(cntrl){cntrl&&cntrl.callback&&cntrl.callback.call(cntrl.callback,data)})},propagateData=function(__handle,data,doNotPropogate){doNotPropogate?doNotPropogate&&"string"===checkPublicationName(doNotPropogate)&&propagateDataLoop(doNotPropogate,data):propagateDataLoop(__handle,data)};return{key:function(){return __key},size:function(){return this.hasData()&&this.isIterable()?__data.length:void 0},eq:function(prop){if(Array.isArray(__data)){if(__data&&isNaN(prop))return __data[prop];if(__data&&!isNaN(prop)&&0>prop)return __data[__data.length-1];if(__data&&!isNaN(prop)&&prop>-1)return __data[prop]}else if(this.hasData())return __data[prop]},setProp:function(prop,value,doNotPropogate){!prop||this.hasData()&&this.isIterable()||(__data?(__data[prop]=value,propagateData(__handle,__data,doNotPropogate)):(__data={},__data[prop]=value,propagateData(__handle,__data,doNotPropogate)),__lastModifiedTime=Date.now())},getProp:function(prop){return!prop||this.hasData()&&this.isIterable()?void 0:__data[prop]},setObject:function(obj,doNotPropogate){!obj||this.hasData()&&this.isIterable()||(__data=obj,__lastModifiedTime=Date.now(),propagateData(__handle,__data,doNotPropogate))},mergeObject:function(obj,doNotPropogate){if(obj&&"object"===$.type(obj)){var temp=this.getData();$.extend(temp,obj),this.setObject(temp,doNotPropogate)}},push:function(data,doNotPropogate){if(data){var self=this;Array.isArray(__data)&&(__data.push(data),__lastModifiedTime=Date.now(),propagateData(__handle,data,doNotPropogate),__autobox&&self.box({key:__key}))}},pop:function(doNotPropogate){var self=this;if(this.hasData()&&this.isIterable()){var data=__data.pop();return __lastModifiedTime=Date.now(),propagateData(__handle,data,doNotPropogate),__autobox&&self.box({key:__key}),data}},unshift:function(data,doNotPropogate){if(data){var self=this;Array.isArray(__data)&&(__data.unshift(data),__lastModifiedTime=Date.now(),propagateData(__handle,data,doNotPropogate),__autobox&&self.box({key:__key}))}},shift:function(doNotPropogate){var self=this;if(this.hasData()&&this.isIterable()){var __d=__data.shift();return __lastModifiedTime=Date.now(),propagateData(__handle,__d,doNotPropogate),__autobox&&self.box({key:__key}),__d}},concat:function(data,doNotPropogate){if(data){var self=this;Array.isArray(__data)&&(__data=__data.concat(data),__lastModifiedTime=Date.now(),propagateData(__handle,__data,doNotPropogate),__autobox&&self.box({key:__key}))}},insert:function(position,data,doNotPropogate){if(position){var self=this;if(this.hasData()&&this.isIterable()){var len=data.length;position>=len-1?(__data.push(data),__lastModifiedTime=Date.now(),propagateData(__handle,data,doNotPropogate)):(__data.splice(position,0,data),__lastModifiedTime=Date.now(),propagateData(__handle,data,doNotPropogate))}__autobox&&self.box({key:__key})}},unique:function(doNotPropogate){var len=__data.length,ret=[],obj={},self=this;if(this.hasData()&&this.isIterable()){for(var i=0;len>i;i++){var arrayItem=JSON.stringify(__data[i]),arrayItemValue=__data[i];void 0===obj[arrayItem]?(ret.push(arrayItemValue),obj[arrayItem]=1):obj[arrayItem]++}__lastModifiedTime=Date.now(),__data=ret}doNotPropogate?checkPublicationName(doNotPropogate)&&$.mediators[doNotPropogate].forEach(function(handle){handle.callback.call(handle.callback,data)}):$.dispatch(__handle,__data),__autobox&&self.box({key:__key})},index:function(prop,value){if(this.hasData()&&this.isIterable()){if(!value)return __data.indexOf(prop);for(var i=0;i<__data.length;i++)if(__data[i][prop]===value)return i}},filter:function(args){return this.hasData()&&this.isIterable()?__data.filter.apply(__data,arguments):void 0},map:function(args){return this.hasData()&&this.isIterable()?__data.map.apply(__data,arguments):void 0},pluck:function(property){if(property){var ret=[];if(this.hasData()&&this.isIterable()){for(var len=this.size(),i=0;len>i;i++)ret.push(__data[i][property]);return ret}}},sort:function(args){return __lastModifiedTime=Date.now(),__data.sort.call(__data,args)},reverse:function(){var self=this;__lastModifiedTime=Date.now(),__data.reverse(),__autobox&&self.box({key:__key})},sortBy:function(props){var orderBy=function(args){var props=arguments;return function(a,b){for(var sortByProperty=function(property){var sortOrder=1;return"-"===property[0]&&(sortOrder=-1,property=property.substr(1)),function(a,b){var result=a[property]<b[property]?-1:a[property]>b[property]?1:0;return result*sortOrder}},i=0,result=0,numberOfProperties=props.length;0===result&&numberOfProperties>i;)result=sortByProperty(props[i])(a,b),i++;return __lastModifiedTime=Date.now(),result}};return this.hasData()&&this.isIterable()?__data.sort(orderBy.apply(null,arguments)):void 0},"delete":function(data,doNotPropogate){var pos;if(0===data||data){var self=this;this.hasData()&&this.isIterable()?(pos=__data.indexOf(data),__data.splice(pos,1),__lastModifiedTime=Date.now()):this.hasData()&&(__lastModifiedTime=Date.now(),delete __data[data]),propagateData(__handle,__data,doNotPropogate),__autobox&&self.box({key:__key})}},run:function(callback){callback.call(callback,this,__data)},poke:function(){this.hasData()&&this.isIterable()&&__handle&&$.mediators[__handle].forEach(function(handle){handle.callback.call(handle.callback,data)})},getHandle:function(){return __handle},setHandle:function(handle){handle&&"string"==typeof handle&&(__handle=handle)},purge:function(){var self=this;if("array"===$.type(__data))__data.length=0;else if("object"===$.type(__data))for(k in __data)__data[k]instanceof Function||delete __data[k];__autobox&&self.box({key:__key})},hasData:function(){return"array"===$.type(__data)&&__data.length||"object"===$.type(__data)&&!$.isEmptyObject(__data)?!0:!1},getType:function(){return Array.isArray(__data)?"array":"object"==typeof __data?"object":void 0},isIterable:function(){return Array.isArray(__data)?!0:!1},forEach:function(callback){if(this.hasData()&&this.isIterable())for(var value,i=-1,len=__data.length;++i<len&&(value=callback.call(__data[i],__data[i],i),value!==!1););},getData:function(){return this.hasData()?__data:void 0},setItemProp:function(index,prop,value,doNotPropogate){var self=this;if(this.hasData()&&this.isIterable()){if(isNaN(index))return;!isNaN(index)&&value?(__data[index][prop]=value,__lastModifiedTime=Date.now(),propagateData(__handle,__data,doNotPropogate)):prop&&!value&&(__data.splice(index,1,prop),__lastModifiedTime=Date.now(),propagateData(__handle,__data,doNotPropogate))}else __data[index]=prop,__lastModifiedTime=Date.now(),propagateData(__handle,__data,value);__autobox&&self.box({key:__key})},getItemProp:function(index,prop){if(this.hasData()&&this.isIterable()){if(isNaN(index))return;return prop?__data[index][prop]:__data[index]}return __data[index]},deleteItemProp:function(index,prop,doNotPropogate){var self=this;if(this.hasData()&&this.isIterable()){if(isNaN(index))return;"string"==typeof prop?(__lastModifiedTime=Date.now(),delete __data[index][prop],propagateData(__handle,__data,doNotPropogate)):prop===!0?(__lastModifiedTime=Date.now(),__data.splice(index,1),propagateData(__handle,__data,prop)):(__lastModifiedTime=Date.now(),__data.splice(index,1),propagateData(__handle,__data,doNotPropogate))}__autobox&&self.box({key:__key})},getLastModTime:function(){return __lastModifiedTime},box:function(options){if(options){var value;__autobox=options.autobox||__autobox,__name=options.name||$.Box.__config.name,__boxName=options.boxName||"keyvaluepairs",__key=options.key||this.getHandle(),value=this.getData(),$.Box.set(__key,value).then(function(item){__lastBoxTime=Date.now()})}},setToAutobox:function(options){__autobox=!0,__name=options.name||$.Box.__config.name,__boxName=options.boxName||"keyvaluepairs",__key=options.key||this.getHandle()},isBoxed:function(){return __lastBoxTime?!0:!1},isAutoBoxed:function(){return __autobox?!0:!1},getLastBoxTime:function(){return __lastBoxTime}}}})}(),function(){"use strict";$.extend({view:{index:0},helpers:{},defineHelper:function(callback){$.extend($.helpers,callback)},View:function(options){var __element;options||(options={}),options&&options.element&&(__element=$(options.element)||$());var parsedTemplate,__template=options.template,__model=options.model,__mediator=options.mediator,__index=options.index||1,__rendered=!1,__variable=options.variable||"data",__events=options.events||[],__isBoundTo=options.model,__dontGetTemplate=options.noTemplate||!1,__startIndexFrom=options.startIndexFrom||!1,__canRender=!0,__startFrom=0,__stopAfter=0,__restartTime=0,__renderViewEveryTime=!1,__lastRenderTime=0,__re=/data-src/gim,__escapeHTML=options.escapeHTML||!1,__renderCount=0,parseView=function(template,variable){var interpolate=/\{=([\s\S]+?)\}/gim;variable=variable||"data",template.replace("'","'");var Template=new Function(variable,"var p=[];p.push('"+template.replace(/[\r\t\n]/g," ").split("'").join("\\'").replace(interpolate,"',$1,'").split("{{").join("');").split("}}").join("p.push('")+"');return p.join('');");return Template},handleEvents=function(){__element&&__events.length&&__events.forEach(function(item){item&&"self"===item.element||item&&!item.element?__element.on(item.event,item.callback):__element.on(item.event,item.element,item.callback)})},extractTemplate=function(){if(__element&&__element.size()&&!__dontGetTemplate)if(__template)__template=__template.replace(__re,"src"),parseView(__template,__variable);else{if(__element.children()[0]&&__element.children().eq(0).is("script"))__template=__element.children("script").html(),__element.empty();else if(__element.children()[0]&&__element.children().eq(0).is("template"))__template=__element.children("template").html(),__element.empty();else{if(!__element[0].childNodes)return;__element[0]&&__element[0].childNodes&&(__template||(__template=__element.html())),__element.empty()}__template&&(__template=__template.replace(__re,"src")),parseView(__template,__variable)}};return parsedTemplate=extractTemplate(),__events&&handleEvents(__events),{render:function(data,append){if(__element){var $this=this;if(__template){__template=__template.replace(__re,"src"),parsedTemplate=parseView(__template,__variable);var renderIterableData=function(data){if("boolean"!==$.type(data)){var Data=data?data:__model;__element.removeClass("cloak"),__element.data("index")?(__index=Number(__element.data("index")),$.view.index=Number(__element.data("index"))):(__index=1,$.view.index=1),interateModelToTemplate(Data),__renderCount++}},interateModelToTemplate=function(Data,append){append||__element.empty(),__startIndexFrom&&($.view.index=__startIndexFrom),Data.forEach(function(item){__index+=1,__escapeHTML&&(item=$.escapeHTML(item)),parsedTemplate&&(__element.append(parsedTemplate(item)),$.view.index+=1)}),__lastRenderTime=Date.now(),__rendered=!0,$.view.index=1},renderSingleObjectView=function(append){__model.run(function(m,d){append||__element.empty(),__escapeHTML&&(d=$.escapeHTML(d)),__element.append(parsedTemplate(d)),__element.removeClass("cloak"),__lastRenderTime=Date.now(),__rendered=!0,__renderCount++})},bindModelToView=function(handle){handle&&"string"==typeof handle&&($.mediators[handle]||($.mediators[handle]=$.MediatorStack()),$.mediators[handle].push({token:$.uuid(),callback:function(){$this.render()},exec:!0,count:0,start:0,after:0,time:0}),__mediator=$.mediators[handle])};if(!parsedTemplate&&__template&&"string"===$.type(__template)&&(parsedTemplate=parseView(__template,__variable)),"array"===$.type(data)){if($.view.index=__startIndexFrom||1,!__canRender)return;return append||__element.empty(),data.forEach(function(item){__escapeHTML&&(item=$.escapeHTML(item)),__element.append(parsedTemplate(item)),$.view.index+=1,__index+=1}),__rendered=!0,$.view.index=0,void __element.removeClass("cloak")}if("object"===$.type(data)||"string"===$.type(data)||"number"===$.type(data))return $.view.index=__startIndexFrom||1,append||__element.empty(),__element.append(parsedTemplate(data)),__element.removeClass("cloak"),void(__rendered=!0);if(__model&&Object.keys(__model).indexOf("poke")>-1){if(!__canRender){if(!(__restartTime>0))return;if(!(__restartTime<Date.now()))return;__canRender=!0,__restartTime=0,bindModelToView(__model.getHandle())}__stopAfter>0?__stopAfter>__startFrom?(__startFrom++,bindModelToView(__model.getHandle())):__startFrom>=__stopAfter&&(__canRender=!1,__startFrom=0,__stopAfter=0):__canRender&&bindModelToView(__model.getHandle()),"object"===__model.getType()?renderSingleObjectView():"array"!==__model.getType()||data||(renderIterableData(data),$.view.index=0,__index=0)}}}},empty:function(){__element&&__element.empty()},resetIndex:function(){__element&&(__index=0,__element.data("index",0),$.view.index=0)},startIndexFrom:function(number){__element&&(0===number||number&&!isNaN(number))&&(__startIndexFrom=number,$.view.index=number,this.render())},getTemplate:function(){return __template},setTemplate:function(template){template&&(__template=template)},getModel:function(){return __model},setModel:function(model){model&&model!==__model&&(__model=model,__model.size()&&this.render(),__isBoundTo&&(this.unbind(),this.bindToModel(model)))},getMediator:function(){return __mediator.getData()[0]},isRendered:function(){return __rendered},isEmpty:function(){return __element?"undefined"==typeof jQuery&&/DOMStack/gim.test(__element.constructor)?__element.array[0].children.length?!1:void 0:__element[0].children.length?!1:!0:void 0},bind:function(model){if(model){var mediator=$.Mediator(model.getHandle());__mediator=mediator;var __v=this;__model=model,mediator.run(function(data){__element&&__v.render()}),__element&&this.render()}},unbind:function(){__model=void 0},addEvent:function(events,replace){replace?__events=events&events.length?events:[events]:events&&events.length?events.forEach(function(event){__events.push(event)}):events&&__events.push(events),handleEvents()},off:function(event,element,callback){__element.off(event,element,callback)},getElement:function(){return __element},setElement:function(element){element&&(__element=$(element),$(element).empty(),handleEvents())},stop:function(after){isNaN(after)?__canRender=!1:(__stopAfter=after,__startFrom=0)},isStopped:function(){return!__canRender},restart:function(time){isNaN(time)?(__canRender=!0,this.render()):(__restartTime=Date.now()+1e3*time,__canRender=!1)},getRestartTime:function(){return __restartTime},renderViewAfter:function(time,data){if(!(!time||isNaN(time)||0>=time)){var $this=this;setTimeout(function(){$this.render(data)},1e3*time)}},renderViewEvery:function(time,callback){if(time&&!isNaN(time)&&Object.keys(__model).indexOf("poke")>-1){__renderViewEveryTime=!0;var $this=this,loop=function($this,callback){__renderViewEveryTime&&setTimeout(function(){__lastRenderTime<__model.getLastModTime()&&(callback&&"function"===$.type(callback)&&callback.apply($this),$this.render()),loop(this,callback)}.bind($this),1e3*time)};loop($this,callback)}},stopRenderViewEvery:function(){__renderViewEveryTime=!1},getLastRenderTime:function(){return __lastRenderTime},escapeHTML:function(boolean){boolean&&(__escapeHTML=!0)},isEscapingHTML:function(){return __escapeHTML},getRenderCount:function(){return __renderCount}}}})}(),function(){"use strict";$.extend({Component:function(options){$[options.name]=function(){return this.options=options,delete this.options.name,$.View(this.options)}}})}(),function(){"use strict";$(function(){$.extend({screens:$("screen")}),$.extend($.screens,{getCurrent:function(){return this.hazClass("current")},getNext:function(){return this.hazClass("next")},getPrevious:function(){return this.hazClass("previous")}})})}(),function(){"use strict";$(function(){$.extend({TruckRoutes:$.Model([],"Truck-Routes"),Router:function(){return $.receive("Truck-Routes",$.noop),{addRoute:function(options){"array"===$.type(options)&&options.forEach(function(item){$.mediators[item.route]||($.mediators[item.route]=$.MediatorStack(),$.mediators[item.route].push({token:$.uuid(),callback:item.callback,
exec:!0,count:0}))})},getFullRoute:function(){return $.TruckRoutes.getData().join("/")},getRoutesStack:function(){return $.TruckRoutes.getData()},getCurrentLoc:function(){var temp=this.getFullRoute().split("/");return temp[temp.length-1]},dispatch:function(route){var temp,id;route.match(/\:/)&&(temp=route.split(":"),id=temp[1],route=temp[0]),$.mediators[route]&&$.mediators[route].getData()[0].callback(id)},pushRoute:function(route){$.TruckRoutes.push(route)},popRoute:function(){return $.TruckRoutes.pop()},unshiftRoute:function(route){$.TruckRoutes.unshift(route)},shiftRoute:function(){return $.TruckRoutes.shift()},insert:function(position,route){$.TruckRoutes.size()>=position?$.TruckRoutes.push(route):$.TruckRoutes.splice(position,0,route)},eq:function(number){return $.TruckRoutes.eq(number)},indexOf:function(route){return $.TruckRoutes.indexOf(route)},"delete":function(route,baseRouteOnly){baseRouteOnly?$.TruckRoutes["delete"](route):$.TruckRoutes.forEach(function(r){r&&route===r.split(":")[0]&&$.TruckRoutes["delete"](r)})}}}}),$.extend($.Router,{dispatch:function(route){if(route){var temp,id;route.match(/\:/)&&(temp=route.split(":"),id=temp[1],route=temp[0]),$.mediators[route]&&$.mediators[route].getData()[0].callback(id)}}}),$.extend($.TruckRoutes,{getFullRoute:function(){return this.getData().join("/")}}),$("screen").size()&&$.TruckRoutes.push($("screen")[0].id,!0)})}(),function(){"use strict";function schedule(func,self){queue.add(func,self),cycle||(cycle=setTimeout(queue.unshift))}function isThenable(obj){var _then,obj_type=typeof obj;return null===obj||"object"!==obj_type&&"function"!==obj_type||(_then=obj.then),"function"==typeof _then?_then:!1}function notify(){for(var i=0;i<this.chain.length;i++)notifyIsolated(this,1===this.state?this.chain[i].success:this.chain[i].failure,this.chain[i]);this.chain.length=0}function notifyIsolated(self,callback,chain){var ret,_then;try{callback===!1?chain.reject(self.msg):(ret=callback===!0?self.msg:callback.call(void 0,self.msg),ret===chain.promise?chain.reject(new TypeError("Promise-chain cycle")):(_then=isThenable(ret))?_then.call(ret,chain.resolve,chain.reject):chain.resolve(ret))}catch(err){chain.reject(err)}}function resolve(msg){var _then,self=this;if(!self.triggered){self.triggered=!0,self.deferred&&(self=self.deferred);try{(_then=isThenable(msg))?schedule(function(){var deferred_wrapper=new MakeDeferred(self);try{_then.call(msg,function(){resolve.apply(deferred_wrapper,arguments)},function(){reject.apply(deferred_wrapper,arguments)})}catch(err){reject.call(deferred_wrapper,err)}}):(self.msg=msg,self.state=1,self.chain.length>0&&schedule(notify,self))}catch(err){reject.call(new MakeDeferred(self),err)}}}function reject(msg){var self=this;self.triggered||(self.triggered=!0,self.deferred&&(self=self.deferred),self.msg=msg,self.state=2,self.chain.length>0&&schedule(notify,self))}function iteratePromises(Constructor,arr,resolver,rejecter){for(var idx=0;idx<arr.length;idx++)!function(idx){Constructor.resolve(arr[idx]).then(function(msg){resolver(idx,msg)},rejecter)}(idx)}function MakeDeferred(self){this.deferred=self,this.triggered=!1}function Deferred(self){this.promise=self,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function Promise(executor){if("function"!=typeof executor)throw new TypeError("Not a function");if(0!==this.isValidPromise)throw new TypeError("Not a promise");this.isValidPromise=1;var deferred=new Deferred(this);this.then=function(success,failure){var obj={success:"function"==typeof success?success:!0,failure:"function"==typeof failure?failure:!1};return obj.promise=new this.constructor(function(resolve,reject){if("function"!=typeof resolve||"function"!=typeof reject)throw new TypeError("Not a function");obj.resolve=resolve,obj.reject=reject}),deferred.chain.push(obj),0!==deferred.state&&schedule(notify,deferred),obj.promise},this["catch"]=function(failure){return this.then(void 0,failure)};try{executor.call(void 0,function(msg){resolve.call(deferred,msg)},function(msg){reject.call(deferred,msg)})}catch(err){reject.call(deferred,err)}}var extend,cycle,queue;extend=function(obj,name,val,config){return Object.defineProperty(obj,name,{value:val,writable:!0,configurable:config!==!1})},queue=function(){function Item(func,self){this.func=func,this.self=self,this.next=void 0}var first,last,item;return{add:function(func,self){item=new Item(func,self),last?last.next=item:first=item,last=item,item=void 0},unshift:function(){var f=first;for(first=last=cycle=void 0;f;)f.func.call(f.self),f=f.next}}}();var PromisePrototype=extend({},"constructor",Promise,!1);return extend(Promise,"prototype",PromisePrototype,!1),extend(PromisePrototype,"isValidPromise",0,!1),extend(Promise,"resolve",function(msg){var Constructor=this;return msg&&"object"==typeof msg&&1===msg.isValidPromise?msg:new Constructor(function(resolve,reject){if("function"!=typeof resolve||"function"!=typeof reject)throw new TypeError("Not a function");resolve(msg)})}),extend(Promise,"reject",function(msg){return new this(function(resolve,reject){if("function"!=typeof resolve||"function"!=typeof reject)throw new TypeError("Not a function");reject(msg)})}),extend(Promise,"all",function(arr){var Constructor=this;return"[object Array]"!==Object.prototype.toString.call(arr)?Constructor.reject(new TypeError("Not an array")):0===arr.length?Constructor.resolve([]):new Constructor(function(resolve,reject){if("function"!=typeof resolve||"function"!=typeof reject)throw new TypeError("Not a function");var len=arr.length,msgs=new Array(len),count=0;iteratePromises(Constructor,arr,function(idx,msg){msgs[idx]=msg,++count===len&&resolve(msgs)},reject)})}),extend(Promise,"race",function(arr){var Constructor=this;return"[object Array]"!==Object.prototype.toString.call(arr)?Constructor.reject(new TypeError("Not an array")):new Constructor(function(resolve,reject){if("function"!=typeof resolve||"function"!=typeof reject)throw new TypeError("Not a function");iteratePromises(Constructor,arr,function(idx,msg){resolve(msg)},reject)})}),"Promise"in window&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise?void 0:window.Promise=Promise}(),function(self){"use strict";function normalizeName(name){if("string"!=typeof name&&(name=String(name)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name))throw new TypeError("Invalid character in header field name");return name.toLowerCase()}function normalizeValue(value){return"string"!=typeof value&&(value=String(value)),value}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){return body.bodyUsed?Promise.reject(new TypeError("Already read")):void(body.bodyUsed=!0)}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader;return reader.readAsArrayBuffer(blob),fileReaderReady(reader)}function readBlobAsText(blob){var reader=new FileReader;return reader.readAsText(blob),fileReaderReady(reader)}function Body(){return this.bodyUsed=!1,this._initBody=function(body){if(this._bodyInit=body,"string"==typeof body)this._bodyText=body;else if(support.blob&&Blob.prototype.isPrototypeOf(body))this._bodyBlob=body;else if(support.formData&&FormData.prototype.isPrototypeOf(body))this._bodyFormData=body;else if(body){if(!support.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(body))throw new Error("unsupported BodyInit type")}else this._bodyText=""},support.blob?(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(readBlobAsArrayBuffer)},this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var rejected=consumed(this);return rejected?rejected:Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(Request.prototype.isPrototypeOf(input)){if(input.bodyUsed)throw new TypeError("Already read");this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,body||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=input;if(this.credentials=options.credentials||this.credentials||"omit",(options.headers||!this.headers)&&(this.headers=new Headers(options.headers)),this.method=normalizeMethod(options.method||this.method||"GET"),this.mode=options.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("="),name=split.shift().replace(/\+/g," "),value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function headers(xhr){var head=new Headers,pairs=xhr.getAllResponseHeaders().trim().split("\n");return pairs.forEach(function(header){var split=header.trim().split(":"),key=split.shift().trim(),value=split.join(":").trim();head.append(key,value)}),head}function Response(bodyInit,options){options||(options={}),this._initBody(bodyInit),this.type="default",this.status=options.status,this.ok=this.status>=200&&this.status<300,this.statusText=options.statusText,this.headers=options.headers instanceof Headers?options.headers:new Headers(options.headers),this.url=options.url||""}if(!self.fetch){Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var list=this.map[name];list||(list=[],this.map[name]=list),list.push(value)},Headers.prototype["delete"]=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){var values=this.map[normalizeName(name)];return values?values[0]:null},Headers.prototype.getAll=function(name){return this.map[normalizeName(name)]||[]},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=[normalizeValue(value)]},Headers.prototype.forEach=function(callback,thisArg){Object.getOwnPropertyNames(this.map).forEach(function(name){this.map[name].forEach(function(value){callback.call(thisArg,value,name,this)},this)},this)};var support={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self},methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];Request.prototype.clone=function(){return new Request(this)},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:""});return response.type="error",response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError("Invalid status code");return new Response(null,{status:status,headers:{location:url}})},self.Headers=Headers,self.Request=Request,self.Response=Response,self.fetch=function(input,init){return new Promise(function(resolve,reject){function responseURL(){return"responseURL"in xhr?xhr.responseURL:/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())?xhr.getResponseHeader("X-Request-URL"):void 0}var request;request=Request.prototype.isPrototypeOf(input)&&!init?input:new Request(input,init);var xhr=new XMLHttpRequest;xhr.onload=function(){var status=1223===xhr.status?204:xhr.status;if(100>status||status>599)return void reject(new TypeError("Network request failed"));var options={status:status,statusText:xhr.statusText,headers:headers(xhr),url:responseURL()},body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError("Network request failed"))},xhr.open(request.method,request.url,!0),"include"===request.credentials&&(xhr.withCredentials=!0),"responseType"in xhr&&support.blob&&(xhr.responseType="blob"),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),xhr.send("undefined"==typeof request._bodyInit?null:request._bodyInit)})},self.fetch.polyfill=!0,$.extend({JSONPCallbacks:[],jsonp:function(url,opts){function generateCallbackName(){var callbackName=settings.callbackName+"_"+($.JSONPCallbacks.length+1);return $.JSONPCallbacks.push(callbackName),callbackName}var settings={timeout:2e3,callbackName:"callback",clear:!0};opts&&$.extend(settings,opts);var callbackName=generateCallbackName();return new Promise(function(resolve,reject){var timeout;window.jsonp=window.jsonp||{},window.jsonp[callbackName]=function(response){resolve({ok:!0,json:function(){return Promise.resolve(response)}}),timeout&&clearTimeout(timeout)};var script=document.createElement("script");if(script.async=!0,script.defer=!0,script.src=url+(url.indexOf("?")>-1?"&":"?")+"callback=jsonp."+callbackName,document.body.appendChild(script),setTimeout(function(){script.parentNode.removeChild(script)}),settings.clear){var pos=$.JSONPCallbacks.indexOf(callbackName);$.JSONPCallbacks.splice(pos,1)}timeout=setTimeout(function(){reject(new Error("JSONP request to "+url+" timed out"))},settings.timeout)})},json:function(response){return response.json()}})}}(window),function(){"use strict";$.extend({formatNumber:function(amount,separator,decimal){var sep=separator||",";if(0===decimal){var num=Math.round(amount);return Number(num).toString().replace(/(?=(?:\d{3})+$)(?!^)/g,sep)}return void 0===decimal?"number"==typeof amount&&amount%1!==0?Number(amount).toString().replace(/\d(?=(\d{3})+\.)/g,"$&"+sep):Number(amount).toString().replace(/(?=(?:\d{3})+$)(?!^)/g,sep):Number(amount).toFixed(decimal).replace(/\d(?=(\d{3})+\.)/g,"$&"+sep)},sum:function(arr){var ret;return ret=Array.isArray(arr)&&arr.length?arr:[].slice.apply(arguments),ret.reduce(function(a,b){return a+b})},currency:function(amount,symbol,separator,decimal){var sym=symbol||"$",sep=separator||",",dec=decimal||2,zero=!1;0===decimal&&(zero=!0);var formatNumber=function(amount,sep){if(zero){var num=Math.round(amount);return Number(num).toString().replace(/^0+/,"").replace(/(?=(?:\d{3})+$)(?!^)/g,sep)}return Number(amount).toFixed(dec).replace(/^0+/,"").replace(/\d(?=(\d{3})+\.)/g,"$&"+sep)};return sym+formatNumber(amount,sep)},formatTime:function(time){var temp=time.split(":"),temp2=temp[0]+":"+temp[1],ampm=time.split(" ")[1];return temp2+" "+ampm},sortDate:function(date1,date2){return new Date(date1)-new Date(date2)},sortNumbers:function(a,b){return a-b},sortNumbersDescending:function(a,b){return b-a}})}(),function(){"use strict";var setValidityStatus=function(element,valid){valid?($(element).prop("valid",!0),$(element).prop("invalid",!1),$(element).addClass("valid").removeClass("invalid")):($(element).prop("valid",!1),$(element).prop("invalid",!0),$(element).addClass("invalid").removeClass("valid"))},checkValidity=function(element,expression){return expression?setValidityStatus(element,!0):setValidityStatus(element,!1),expression};$.fn.extend({isNotEmpty:function(ctx){return"INPUT"===this[0].nodeName?checkValidity(this,"INPUT"===this[0].nodeName&&this[0].value):void 0},validateAlphabetic:function(){if("INPUT"===this[0].nodeName){var letters=/^[A-Za-z]+$/,value="INPUT"===this[0].nodeName&&this[0].value;return checkValidity(this,value.match(letters)),value?checkValidity(this,value.match(letters)):void 0}},validateNumber:function(){if("INPUT"===this[0].nodeName){var numbers=/^[+-]?\d+(\.\d+)?$/,value="INPUT"===this[0].nodeName&&this[0].value;return checkValidity(this,value.match(numbers)),value?checkValidity(this,value.match(numbers)):void 0}},validateAlphaNumeric:function(){if("INPUT"===this[0].nodeName){var letters=/^[0-9a-zA-Z]+$/,value="INPUT"===this[0].nodeName&&this[0].value;return checkValidity(this,value.match(letters)),value?checkValidity(this,value.match(letters)):void 0}},validateUserName:function(minimum){if("INPUT"===this[0].nodeName){var letters=/^[a-zA-Z0-9]+$/,username=this[0].value;return username?minimum&&username.match(letters)?username.length>=minimum?checkValidity(this,username):checkValidity(this,!1):checkValidity(this,checkValidity(this,username.match(letters))):checkValidity(this,username)}},validateEmail:function(){if("INPUT"===this[0].nodeName){var value=this[0].value,email=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;return value?checkValidity(this,value.match(email)):checkValidity(this,!1)}},validatePhoneNumber:function(){if("INPUT"===this[0].nodeName){var phone,phoneNumber,convertLettersToNumbers=function(value){var phonenumber="";value=value.toLowerCase();for(var len=value.length,i=0;len>i;i++){var character=value.charAt(i);switch(character){case"0":phonenumber+="0";break;case"1":phonenumber+="1";break;case"2":phonenumber+="2";break;case"3":phonenumber+="3";break;case"4":phonenumber+="4";break;case"5":phonenumber+="5";break;case"6":phonenumber+="6";break;case"7":phonenumber+="7";break;case"8":phonenumber+="8";break;case"9":phonenumber+="9";break;case"-":phonenumber+="-";break;case"a":case"b":case"c":phonenumber+="2";break;case"d":case"e":case"f":phonenumber+="3";break;case"g":case"h":case"i":phonenumber+="4";break;case"j":case"k":case"l":phonenumber+="5";break;case"m":case"n":case"o":phonenumber+="6";break;case"p":case"q":case"r":case"s":phonenumber+="7";break;case"t":case"u":case"v":phonenumber+="8";break;case"w":case"x":case"y":case"z":phonenumber+="9"}}return phonenumber};return this[0].value?int?(phoneNumber=this[0].value.replace(/[\(\)\.\-\ ]/g,""),checkValidity(this,this.isNotEmpty()&&!isNaN(phoneNumber))):(phoneNumber=this[0].value.replace(/[\(\)\.\-\ ]/g,""),phoneNumber=convertLettersToNumbers(phoneNumber),phone=/((\(\d{3}\)?)|(\d{3}))([\s-.\/]?)(\d{3})([\s-.\/]?)(\d{4})/,checkValidity(this,phoneNumber.match(phone))):checkValidity(this,!1)}},validateUrl:function(){if("INPUT"===this[0].nodeName){if(this[0].value){var url=/^(ftp|http|https):\/\/([w]{3}\.)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;return checkValidity(this,this[0].value.match(url))}return checkValidity(this,!1)}},validateAge:function(minimum){if("INPUT"===this[0].nodeName&&minimum){var age=this[0].value;return age?checkValidity(this,age>=minimum):checkValidity(this,!1)}},validateCheckbox:function(){return"INPUT"===this[0].nodeName&&"INPUT"===this[0].nodeName&&"checkbox"===this[0].type?checkValidity(this,this[0].checked===!0):void 0},validateRadioButtons:function(){if("INPUT"===this[0].nodeName){var choice=!1;return"INPUT"===this[0].nodeName&&"radio"===this[0].type?($.each(this,function(idx,button){button.checked===!0&&(choice=!0)}),checkValidity(this,choice)):void 0}},validateSelectBox:function(){return"SELECT"===this[0].nodeName?checkValidity(this,this[0].selectedIndex):void 0},validateSwitch:function(){var checkbox=this.find("input[type=checkbox]")[0];return checkbox.checked?!0:!1},validateSelectList:function(){var radio=this.find("input[type=radio]");return radio.iz("[checked]")[0]?!0:!1},validateMultiSelectList:function(){var checkboxes=this.find("input[type=checkbox]"),checked=!1;return checkboxes.forEach(function(item){$(item).prop("checked")&&(checked=!0)}),checked?!0:!1}}),$.extend({validatePassword:function(input1,input2,minimum){if(minimum&&$(input1).val().length<minimum||$(input2).val().length<minimum)return $(input1).addClass("invalid").removeClass("valid"),$(input2).addClass("invalid").removeClass("valid"),!1;var letters=/^(?=.*[a-zA-Z])(?=.*[0-9]).+$/;return letters.test($(input1).val())||letters.test($(input2).val())?($(input1).val()===$(input2).val()?($(input1).removeClass("invalid").addClass("valid"),$(input2).removeClass("invalid").addClass("valid")):($(input1).addClass("invalid").removeClass("valid"),$(input2).addClass("invalid").removeClass("valid")),$(input1).val()===$(input2).val()):!1},validateWithRegex:function(input,regex){if(!regex)return void console.error("This method requires a regular expression.");var value=$(input).val();return value?checkValidity(input,value.match(regex)):void 0},customValidators:[],registerCustomValidator:function(name,regex){this.customValidators.push({name:name,regex:regex})}})}(),function(){"use strict";$.extend({Box:function(){function callWhenReady(truckBoxInstance,libraryMethod){truckBoxInstance[libraryMethod]=function(){var __args=arguments;return truckBoxInstance.ready().then(function(){return truckBoxInstance[libraryMethod].apply(truckBoxInstance,__args)})}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg)for(var key in arg)arg.hasOwnProperty(key)&&(isArray(arg[key])?arguments[0][key]=arg[key].slice():arguments[0][key]=arg[key])}return arguments[0]}function isLibraryDriver(driverName){for(var driver in DriverType)if(DriverType.hasOwnProperty(driver)&&DriverType[driver]===driverName)return!0;return!1}(function(){function __createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var BlobBuilder=globalObject.BlobBuilder||globalObject.MSBlobBuilder||globalObject.MozBlobBuilder||globalObject.WebKitBlobBuilder,builder=new BlobBuilder,i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}function __binStringToArrayBuffer(bin){for(var length=bin.length,buf=new ArrayBuffer(length),arr=new Uint8Array(buf),i=0;length>i;i++)arr[i]=bin.charCodeAt(i);return buf}function __blobAjax(url){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest;xhr.open("GET",url),xhr.withCredentials=!0,xhr.responseType="arraybuffer",xhr.onreadystatechange=function(){return 4===xhr.readyState?200===xhr.status?resolve({response:xhr.response,type:xhr.getResponseHeader("Content-Type")}):void reject({status:xhr.status,response:xhr.response}):void 0},xhr.send()})}function __checkBlobSupportWithoutCaching(idb){return new Promise(function(resolve,reject){var blob=__createBlob([""],{type:"image/png"}),txn=idb.transaction([DETECT_BLOB__support_STORE],"readwrite");txn.objectStore(DETECT_BLOB__support_STORE).put(blob,"key"),txn.oncomplete=function(){var blobTxn=idb.transaction([DETECT_BLOB__support_STORE],"readwrite"),getBlobReq=blobTxn.objectStore(DETECT_BLOB__support_STORE).get("key");getBlobReq.onerror=reject,getBlobReq.onsuccess=function(e){var storedBlob=e.target.result,url=URL.createObjectURL(storedBlob);__blobAjax(url).then(function(res){resolve(!(!res||"image/png"!==res.type))},function(){resolve(!1)}).then(function(){URL.revokeObjectURL(url)})}}})["catch"](function(){return!1})}function __checkBlobSupport(idb){return"boolean"==typeof supportsBlobs?Promise.resolve(supportsBlobs):__checkBlobSupportWithoutCaching(idb).then(function(value){return supportsBlobs=value})}function __encodeBlob(blob){return new Promise(function(resolve,reject){var reader=new FileReader;reader.onerror=reject,reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__truck_box_encoded_blob:!0,data:base64,type:blob.type})},reader.readAsBinaryString(blob)})}function __decodeBlob(encodedBlob){var arrayBuff=__binStringToArrayBuffer(atob(encodedBlob.data));return __createBlob([arrayBuff],{type:encodedBlob.type})}function __isEncodedBlob(value){return value&&value.__truck_box_encoded_blob}function __initStorage(options){function ignoreErrors(){return Promise.resolve()}var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]=options[i];dbContexts||(dbContexts={});var dbContext=dbContexts[dbInfo.name];dbContext||(dbContext={box:[],db:null},dbContexts[dbInfo.name]=dbContext),dbContext.box.push(this);for(var readyPromises=[],j=0;j<dbContext.box.length;j++){var truckbox=dbContext.box[j];truckbox!==this&&readyPromises.push(truckbox.ready()["catch"](ignoreErrors))}var box=dbContext.box.slice(0);return Promise.all(readyPromises).then(function(){return dbInfo.db=dbContext.db,__getOriginalConnection(dbInfo)}).then(function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo,self.__defaultConfig.version)?__getUpgradedConnection(dbInfo):db}).then(function(db){dbInfo.db=dbContext.db=db,self.__dbInfo=dbInfo;for(var k in box){var truckbox=box[k];truckbox!==self&&(truckbox.__dbInfo.db=dbInfo.db,truckbox.__dbInfo.version=dbInfo.version)}})}function __getOriginalConnection(dbInfo){return __getConnection(dbInfo,!1)}function __getUpgradedConnection(dbInfo){return __getConnection(dbInfo,!0)}function __getConnection(dbInfo,upgradeNeeded){return new Promise(function(resolve,reject){if(dbInfo.db){if(!upgradeNeeded)return resolve(dbInfo.db);dbInfo.db.close()}var dbArgs=[dbInfo.name];upgradeNeeded&&dbArgs.push(dbInfo.version);var openreq=indexedDB.open.apply(indexedDB,dbArgs);upgradeNeeded&&(openreq.onupgradeneeded=function(e){var db=openreq.result;try{db.createObjectStore(dbInfo.boxName),e.oldVersion<=1&&db.createObjectStore(DETECT_BLOB__support_STORE)}catch(ex){if("ConstraintError"!==ex.name)throw ex;globalObject.console.warn('The database "'+dbInfo.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+dbInfo.boxName+'" already exists.')}}),openreq.onerror=function(){reject(openreq.error)},openreq.onsuccess=function(){resolve(openreq.result)}})}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db)return!0;var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.boxName),isDowngrade=dbInfo.version<dbInfo.db.version,isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade&&(dbInfo.version!==defaultVersion&&globalObject.console.warn('The database "'+dbInfo.name+"\" can't be downgraded from version "+dbInfo.db.version+" to version "+dbInfo.version+"."),dbInfo.version=dbInfo.db.version),isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;incVersion>dbInfo.version&&(dbInfo.version=incVersion)}return!0}return!1}function get(key,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo,store=dbInfo.db.transaction(dbInfo.boxName,"readonly").objectStore(dbInfo.boxName),req=store.get(key);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),__isEncodedBlob(value)&&(value=__decodeBlob(value)),resolve(value)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function each(iterator,callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo,store=dbInfo.db.transaction(dbInfo.boxName,"readonly").objectStore(dbInfo.boxName),req=store.openCursor(),iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;__isEncodedBlob(value)&&(value=__decodeBlob(value));var result=iterator(value,cursor.key,iterationNumber++);void 0!==result?resolve(result):cursor["continue"]()}else resolve()},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function set(key,value,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise(function(resolve,reject){var dbInfo;self.ready().then(function(){return dbInfo=self.__dbInfo,__checkBlobSupport(dbInfo.db)}).then(function(blobSupport){return!blobSupport&&value instanceof Blob?__encodeBlob(value):value}).then(function(value){var transaction=dbInfo.db.transaction(dbInfo.boxName,"readwrite"),store=transaction.objectStore(dbInfo.boxName);null===value&&(value=void 0);var req=store.put(value,key);transaction.oncomplete=function(){void 0===value&&(value=null),resolve(value)},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});return executeCallback(promise,callback),promise}function remove(key,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo,transaction=dbInfo.db.transaction(dbInfo.boxName,"readwrite"),store=transaction.objectStore(dbInfo.boxName),req=store["delete"](key);transaction.oncomplete=function(){resolve()},transaction.onerror=function(){reject(req.error)},transaction.onabort=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});return executeCallback(promise,callback),promise}function clear(callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo,transaction=dbInfo.db.transaction(dbInfo.boxName,"readwrite"),store=transaction.objectStore(dbInfo.boxName),req=store.clear();transaction.oncomplete=function(){resolve()},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});return executeCallback(promise,callback),promise}function size(callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo,store=dbInfo.db.transaction(dbInfo.boxName,"readonly").objectStore(dbInfo.boxName),req=store.count();req.onsuccess=function(){resolve(req.result)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function key(n,callback){var self=this,promise=new Promise(function(resolve,reject){return 0>n?void resolve(null):void self.ready().then(function(){var dbInfo=self.__dbInfo,store=dbInfo.db.transaction(dbInfo.boxName,"readonly").objectStore(dbInfo.boxName),advanced=!1,req=store.openCursor();req.onsuccess=function(){var cursor=req.result;return cursor?void(0===n?resolve(cursor.key):advanced?resolve(cursor.key):(advanced=!0,cursor.advance(n))):void resolve(null)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function keys(callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo,store=dbInfo.db.transaction(dbInfo.boxName,"readonly").objectStore(dbInfo.boxName),req=store.openCursor(),keys=[];req.onsuccess=function(){var cursor=req.result;return cursor?(keys.push(cursor.key),void cursor["continue"]()):void resolve(keys)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}var globalObject=this,indexedDB=indexedDB||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(indexedDB){var supportsBlobs,dbContexts,DETECT_BLOB__support_STORE="truck-box-detect-blob-support",asyncStorage={__driver:"asyncStorage",
__initStorage:__initStorage,each:each,get:get,set:set,remove:remove,clear:clear,size:size,key:key,keys:keys};this.asyncStorage=asyncStorage,window.asyncStorage=asyncStorage}}).call(window),function(){function __initStorage(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]="string"!=typeof options[i]?options[i].toString():options[i];var dbInfoPromise=new Promise(function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return self.setDriver(self.LOCALSTORAGE).then(function(){return self.__initStorage(options)}).then(resolve)["catch"](reject)}dbInfo.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.boxName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){self.__dbInfo=dbInfo,resolve()},function(t,error){reject(error)})})});return new Promise(function(resolve,reject){resolve(truckBoxSerializer)}).then(function(lib){return dbInfo.serializer=lib,dbInfoPromise})}function get(key,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.boxName+" WHERE key = ? LIMIT 1",[key],function(t,results){var result=results.rows.length?results.rows.item(0).value:null;result&&(result=dbInfo.serializer.deserialize(result)),resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function each(iterator,callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.boxName,[],function(t,results){for(var rows=results.rows,length=rows.length,i=0;length>i;i++){var item=rows.item(i),result=item.value;if(result&&(result=dbInfo.serializer.deserialize(result)),result=iterator(result,item.key,i+1),void 0!==result)return void resolve(result)}resolve()},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function set(key,value,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise(function(resolve,reject){self.ready().then(function(){void 0===value&&(value=null);var originalValue=value,dbInfo=self.__dbInfo;dbInfo.serializer.serialize(value,function(value,error){error?reject(error):dbInfo.db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO "+dbInfo.boxName+" (key, value) VALUES (?, ?)",[key,value],function(){resolve(originalValue)},function(t,error){reject(error)})},function(sqlError){sqlError.code===sqlError.QUOTA_ERR&&reject(sqlError)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function remove(key,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.boxName+" WHERE key = ?",[key],function(){resolve()},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function clear(callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.boxName,[],function(){resolve()},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function size(callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+dbInfo.boxName,[],function(t,results){var result=results.rows.item(0).c;resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function key(n,callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.boxName+" WHERE id = ? LIMIT 1",[n+1],function(t,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function keys(callback){var self=this,promise=new Promise(function(resolve,reject){self.ready().then(function(){var dbInfo=self.__dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.boxName,[],function(t,results){for(var keys=[],i=0;i<results.rows.length;i++)keys.push(results.rows.item(i).key);resolve(keys)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}var globalObject=this,openDatabase=this.openDatabase;if(openDatabase){var webSQLStorage={__driver:"webSQLStorage",__initStorage:__initStorage,each:each,get:get,set:set,remove:remove,clear:clear,size:size,key:key,keys:keys};this.webSQLStorage=webSQLStorage,window.webSQLStorage=webSQLStorage}}.call(window),function(){function __initStorage(options){var self=this,dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];return dbInfo.keyPrefix=dbInfo.name+"/",dbInfo.boxName!==self.__defaultConfig.boxName&&(dbInfo.keyPrefix+=dbInfo.boxName+"/"),self.__dbInfo=dbInfo,new Promise(function(resolve,reject){resolve(truckBoxSerializer)}).then(function(lib){return dbInfo.serializer=lib,Promise.resolve()})}function clear(callback){var self=this,promise=self.ready().then(function(){for(var keyPrefix=self.__dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}});return executeCallback(promise,callback),promise}function get(key,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self.__dbInfo,result=localStorage.getItem(dbInfo.keyPrefix+key);return result&&(result=dbInfo.serializer.deserialize(result)),result});return executeCallback(promise,callback),promise}function each(iterator,callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self.__dbInfo,keyPrefix=dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length=localStorage.length,iterationNumber=1,i=0;length>i;i++){var key=localStorage.key(i);if(0===key.indexOf(keyPrefix)){var value=localStorage.getItem(key);if(value&&(value=dbInfo.serializer.deserialize(value)),value=iterator(value,key.substring(keyPrefixLength),iterationNumber++),void 0!==value)return value}}});return executeCallback(promise,callback),promise}function key(n,callback){var self=this,promise=self.ready().then(function(){var result,dbInfo=self.__dbInfo;try{result=localStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result});return executeCallback(promise,callback),promise}function keys(callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self.__dbInfo,length=localStorage.length,keys=[],i=0;length>i;i++)0===localStorage.key(i).indexOf(dbInfo.keyPrefix)&&keys.push(localStorage.key(i).substring(dbInfo.keyPrefix.length));return keys});return executeCallback(promise,callback),promise}function size(callback){var self=this,promise=self.keys().then(function(keys){return keys.length});return executeCallback(promise,callback),promise}function remove(key,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self.__dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key)});return executeCallback(promise,callback),promise}function set(key,value,callback){var self=this;"string"!=typeof key&&(globalObject.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){void 0===value&&(value=null);var originalValue=value;return new Promise(function(resolve,reject){var dbInfo=self.__dbInfo;dbInfo.serializer.serialize(value,function(value,error){if(error)reject(error);else try{localStorage.setItem(dbInfo.keyPrefix+key,value),resolve(originalValue)}catch(e){("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&reject(e),reject(e)}})})});return executeCallback(promise,callback),promise}function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}var globalObject=this,localStorage=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;localStorage=this.localStorage}catch(e){return}var localStorageWrapper={__driver:"localStorageWrapper",__initStorage:__initStorage,each:each,get:get,set:set,remove:remove,clear:clear,size:size,key:key,keys:keys};this.localStorageWrapper=localStorageWrapper,window.localStorageWrapper=localStorageWrapper}.call(window),function(){function __createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(err){if("TypeError"!==err.name)throw err;for(var BlobBuilder=globalObject.BlobBuilder||globalObject.MSBlobBuilder||globalObject.MozBlobBuilder||globalObject.WebKitBlobBuilder,builder=new BlobBuilder,i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}function serialize(value,callback){var valueString="";if(value&&(valueString=value.toString()),value&&("[object ArrayBuffer]"===value.toString()||value.buffer&&"[object ArrayBuffer]"===value.buffer.toString())){var buffer,marker=SERIALIZED_MARKER;value instanceof ArrayBuffer?(buffer=value,marker+=TYPE_ARRAYBUFFER):(buffer=value.buffer,"[object Int8Array]"===valueString?marker+=TYPE_INT8ARRAY:"[object Uint8Array]"===valueString?marker+=TYPE_UINT8ARRAY:"[object Uint8ClampedArray]"===valueString?marker+=TYPE_UINT8CLAMPEDARRAY:"[object Int16Array]"===valueString?marker+=TYPE_INT16ARRAY:"[object Uint16Array]"===valueString?marker+=TYPE_UINT16ARRAY:"[object Int32Array]"===valueString?marker+=TYPE_INT32ARRAY:"[object Uint32Array]"===valueString?marker+=TYPE_UINT32ARRAY:"[object Float32Array]"===valueString?marker+=TYPE_FLOAT32ARRAY:"[object Float64Array]"===valueString?marker+=TYPE_FLOAT64ARRAY:callback(new Error("Failed to get type for BinaryArray"))),callback(marker+bufferToString(buffer))}else if("[object Blob]"===valueString){var fileReader=new FileReader;fileReader.onload=function(){var str=BLOB_TYPE_PREFIX+value.type+"~"+bufferToString(this.result);callback(SERIALIZED_MARKER+TYPE_BLOB+str)},fileReader.readAsArrayBuffer(value)}else try{callback(JSON.stringify(value))}catch(e){console.error("Couldn't convert value into a JSON string: ",value),callback(null,e)}}function deserialize(value){if(value.substring(0,SERIALIZED_MARKER_LENGTH)!==SERIALIZED_MARKER)return JSON.parse(value);var blobType,serializedString=value.substring(TYPE_SERIALIZED_MARKER_LENGTH),type=value.substring(SERIALIZED_MARKER_LENGTH,TYPE_SERIALIZED_MARKER_LENGTH);if(type===TYPE_BLOB&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1],serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case TYPE_ARRAYBUFFER:return buffer;case TYPE_BLOB:return __createBlob([buffer],{type:blobType});case TYPE_INT8ARRAY:return new Int8Array(buffer);case TYPE_UINT8ARRAY:return new Uint8Array(buffer);case TYPE_UINT8CLAMPEDARRAY:return new Uint8ClampedArray(buffer);case TYPE_INT16ARRAY:return new Int16Array(buffer);case TYPE_UINT16ARRAY:return new Uint16Array(buffer);case TYPE_INT32ARRAY:return new Int32Array(buffer);case TYPE_UINT32ARRAY:return new Uint32Array(buffer);case TYPE_FLOAT32ARRAY:return new Float32Array(buffer);case TYPE_FLOAT64ARRAY:return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}}function stringToBuffer(serializedString){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*serializedString.length,len=serializedString.length,p=0;"="===serializedString[serializedString.length-1]&&(bufferLength--,"="===serializedString[serializedString.length-2]&&bufferLength--);var buffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(buffer);for(i=0;len>i;i+=4)encoded1=BASE_CHARS.indexOf(serializedString[i]),encoded2=BASE_CHARS.indexOf(serializedString[i+1]),encoded3=BASE_CHARS.indexOf(serializedString[i+2]),encoded4=BASE_CHARS.indexOf(serializedString[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return buffer}function bufferToString(buffer){var i,bytes=new Uint8Array(buffer),base64String="";for(i=0;i<bytes.length;i+=3)base64String+=BASE_CHARS[bytes[i]>>2],base64String+=BASE_CHARS[(3&bytes[i])<<4|bytes[i+1]>>4],base64String+=BASE_CHARS[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64String+=BASE_CHARS[63&bytes[i+2]];return bytes.length%3===2?base64String=base64String.substring(0,base64String.length-1)+"=":bytes.length%3===1&&(base64String=base64String.substring(0,base64String.length-2)+"=="),base64String}var BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BLOB_TYPE_PREFIX="~~truck_box_type~",BLOB_TYPE_PREFIX_REGEX=/^~~truck_box_type~([^~]+)~/,SERIALIZED_MARKER="__lfsc__:",SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length,TYPE_ARRAYBUFFER="arbf",TYPE_BLOB="blob",TYPE_INT8ARRAY="si08",TYPE_UINT8ARRAY="ui08",TYPE_UINT8CLAMPEDARRAY="uic8",TYPE_INT16ARRAY="si16",TYPE_INT32ARRAY="si32",TYPE_UINT16ARRAY="ur16",TYPE_UINT32ARRAY="ui32",TYPE_FLOAT32ARRAY="fl32",TYPE_FLOAT64ARRAY="fl64",TYPE_SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER_LENGTH+TYPE_ARRAYBUFFER.length,globalObject=this,truckBoxSerializer={serialize:serialize,deserialize:deserialize,stringToBuffer:stringToBuffer,bufferToString:bufferToString};this.truckBoxSerializer=truckBoxSerializer,window.truckBoxSerializer=truckBoxSerializer}.call(window);var CustomDrivers={},DriverType={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},DefaultDriverOrder=[DriverType.INDEXEDDB,DriverType.WEBSQL,DriverType.LOCALSTORAGE],LibraryMethods=["clear","get","each","key","keys","size","remove","set"],DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"truckbox",size:4980736,boxName:"keyvaluepairs",version:1},driverSupport=function(self){var indexedDB=indexedDB||self.indexedDB||self.webkitIndexedDB||self.mozIndexedDB||self.OIndexedDB||self.msIndexedDB,result={};return result[DriverType.WEBSQL]=!!self.openDatabase,result[DriverType.INDEXEDDB]=!!function(){if("undefined"!=typeof self.openDatabase&&self.navigator&&self.navigator.userAgent&&/Safari/.test(self.navigator.userAgent)&&!/Chrome/.test(self.navigator.userAgent))return!1;try{return indexedDB&&"function"==typeof indexedDB.open&&"undefined"!=typeof self.IDBKeyRange}catch(e){return!1}}(),result[DriverType.LOCALSTORAGE]=!!function(){try{return self.localStorage&&"setItem"in self.localStorage&&self.localStorage.setItem}catch(e){return!1}}(),result}(window),isArray=Array.isArray||function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},TruckBox=function(){function TruckBox(options){this.INDEXEDDB=DriverType.INDEXEDDB,this.LOCALSTORAGE=DriverType.LOCALSTORAGE,this.WEBSQL=DriverType.WEBSQL,this.__defaultConfig=extend({},DefaultConfig),this.__config=extend({},this.__defaultConfig,options),this.__driverSet=null,this.__initDriver=null,this.__ready=!1,this.__dbInfo=null,this.__wrapLibraryMethodsWithReady(),this.setDriver(this.__config.driver)}return TruckBox.prototype.config=function(options){if("object"==typeof options){if(this.__ready)return new Error("Can't call config() after truckbox has been used.");for(var i in options)"boxName"===i&&(options[i]=options[i].replace(/\W/g,"_")),this.__config[i]=options[i];return"driver"in options&&options.driver&&this.setDriver(this.__config.driver),!0}return"string"==typeof options?this.__config[options]:this.__config},TruckBox.prototype.defineDriver=function(driverObject,callback,errorCallback){var promise=new Promise(function(resolve,reject){try{var driverName=driverObject.__driver,complianceError=new Error("Custom driver not compliant; see Truck Box documentation"),namingError=new Error("Custom driver name already in use: "+driverObject.__driver);if(!driverObject.__driver)return void reject(complianceError);if(isLibraryDriver(driverObject.__driver))return void reject(namingError);for(var customDriverMethods=LibraryMethods.concat("__initStorage"),i=0;i<customDriverMethods.length;i++){var customDriverMethod=customDriverMethods[i];if(!customDriverMethod||!driverObject[customDriverMethod]||"function"!=typeof driverObject[customDriverMethod])return void reject(complianceError)}var supportPromise=Promise.resolve(!0);"__support"in driverObject&&(supportPromise=driverObject.__support&&"function"==typeof driverObject.__support?driverObject.__support():Promise.resolve(!!driverObject.__support)),supportPromise.then(function(supportResult){driverSupport[driverName]=supportResult,CustomDrivers[driverName]=driverObject,resolve()},reject)}catch(e){reject(e)}});return promise.then(callback,errorCallback),promise},TruckBox.prototype.driver=function(){return this.__driver||null},TruckBox.prototype.getDriver=function(driverName,callback,errorCallback){var self=this,getDriverPromise=function(){if(isLibraryDriver(driverName))switch(driverName){case self.INDEXEDDB:return new Promise(function(resolve,reject){resolve(asyncStorage)});case self.LOCALSTORAGE:return new Promise(function(resolve,reject){resolve(localStorageWrapper)});case self.WEBSQL:return new Promise(function(resolve,reject){resolve(webSQLStorage)})}else if(CustomDrivers[driverName])return console.log("Using: "+driverName),Promise.resolve(CustomDrivers[driverName]);return Promise.reject(new Error("Driver not found."))}();return getDriverPromise.then(callback,errorCallback),getDriverPromise},TruckBox.prototype.getSerializer=function(callback){var serializerPromise=new Promise(function(resolve,reject){resolve(truckBoxSerializer)});return callback&&"function"==typeof callback&&serializerPromise.then(function(result){callback(result)}),serializerPromise},TruckBox.prototype.ready=function(callback){var self=this,promise=self.__driverSet.then(function(){return null===self.__ready&&(self.__ready=self.__initDriver()),self.__ready});return promise.then(callback,callback),promise},TruckBox.prototype.setDriver=function(drivers,callback,errorCallback){function setDriverToConfig(){self.__config.driver=self.driver()}function initDriver(supportedDrivers){return function(){function driverPromiseLoop(){for(;currentDriverIndex<supportedDrivers.length;){var driverName=supportedDrivers[currentDriverIndex];return currentDriverIndex++,self.__dbInfo=null,self.__ready=null,self.getDriver(driverName).then(function(driver){return self.__extend(driver),setDriverToConfig(),self.__ready=self.__initStorage(self.__config),self.__ready})["catch"](driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");return self.__driverSet=Promise.reject(error),self.__driverSet}var currentDriverIndex=0;return driverPromiseLoop()}}var self=this;isArray(drivers)||(drivers=[drivers]);var supportedDrivers=this.__getSupportedDrivers(drivers),oldDriverSetDone=null!==this.__driverSet?this.__driverSet["catch"](function(){return Promise.resolve()}):Promise.resolve();return this.__driverSet=oldDriverSetDone.then(function(){var driverName=supportedDrivers[0];return self.__dbInfo=null,self.__ready=null,self.getDriver(driverName).then(function(driver){self.__driver=driver.__driver,setDriverToConfig(),self.__wrapLibraryMethodsWithReady(),self.__initDriver=initDriver(supportedDrivers)})})["catch"](function(){setDriverToConfig();var error=new Error("No available storage method found.");return self.__driverSet=Promise.reject(error),self.__driverSet}),this.__driverSet.then(callback,errorCallback),this.__driverSet},TruckBox.prototype.supports=function(driverName){return!!driverSupport[driverName]},TruckBox.prototype.__extend=function(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)},TruckBox.prototype.__getSupportedDrivers=function(drivers){for(var supportedDrivers=[],i=0,len=drivers.length;len>i;i++){var driverName=drivers[i];this.supports(driverName)&&supportedDrivers.push(driverName)}return supportedDrivers},TruckBox.prototype.__wrapLibraryMethodsWithReady=function(){for(var i=0;i<LibraryMethods.length;i++)callWhenReady(this,LibraryMethods[i])},TruckBox.prototype.createInstance=function(options){return new TruckBox(options)},TruckBox}(),truckBox=new TruckBox;return truckBox}()})}(),function(){"use strict";function getSupport(){try{if(globalObject.sessionStorage&&"setItem"in globalObject.sessionStorage)return!0}catch(e){}return!1}function __initStorage(options){var self=this,dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];dbInfo.keyPrefix=dbInfo.name+"/",self.__dbInfo=dbInfo;var serializerPromise=new Promise(function(resolve,reject){return"function"==typeof self.getSerializer?void self.getSerializer().then(resolve,reject):void resolve(globalObject.truckBoxSerializer)});return serializerPromise.then(function(lib){return serializer=lib,Promise.resolve()})}function clear(callback){var self=this,promise=self.ready().then(function(){for(var keyPrefix=self.__dbInfo.keyPrefix,i=sessionStorage.length-1;i>=0;i--){var key=sessionStorage.key(i);0===key.indexOf(keyPrefix)&&sessionStorage.removeItem(key)}});return executeCallback(promise,callback),promise}function get(key,callback){var self=this;"string"!=typeof key&&(window.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self.__dbInfo,result=sessionStorage.getItem(dbInfo.keyPrefix+key);return result&&(result=serializer.deserialize(result)),result});return executeCallback(promise,callback),promise}function each(iterator,callback){var self=this,promise=self.ready().then(function(){for(var keyPrefix=self.__dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length=sessionStorage.length,i=0;length>i;i++){var key=sessionStorage.key(i),value=sessionStorage.getItem(key);if(value&&(value=serializer.deserialize(value)),value=iterator(value,key.substring(keyPrefixLength),i+1),void 0!==value)return value}});return executeCallback(promise,callback),promise}function key(n,callback){var self=this,promise=self.ready().then(function(){var result,dbInfo=self.__dbInfo;try{result=sessionStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result});return executeCallback(promise,callback),promise}function keys(callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self.__dbInfo,length=sessionStorage.length,keys=[],i=0;length>i;i++)0===sessionStorage.key(i).indexOf(dbInfo.keyPrefix)&&keys.push(sessionStorage.key(i).substring(dbInfo.keyPrefix.length));return keys});return executeCallback(promise,callback),promise}function size(callback){var self=this,promise=self.keys().then(function(keys){return keys.length});return executeCallback(promise,callback),promise}function remove(key,callback){var self=this;"string"!=typeof key&&(window.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self.__dbInfo;sessionStorage.removeItem(dbInfo.keyPrefix+key)});return executeCallback(promise,callback),promise}function set(key,value,callback){var self=this;"string"!=typeof key&&(window.console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){void 0===value&&(value=null);var originalValue=value;return new Promise(function(resolve,reject){serializer.serialize(value,function(value,error){if(error)reject(error);else try{var dbInfo=self.__dbInfo;sessionStorage.setItem(dbInfo.keyPrefix+key,value),resolve(originalValue)}catch(e){("QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&reject(e),reject(e)}})})});return executeCallback(promise,callback),promise}function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}var globalObject=this,serializer=null,sessionStorage=null;if(getSupport()){sessionStorage=this.sessionStorage;var sessionStorageDriver={__driver:"sessionStorageDriver",__initStorage:__initStorage,__support:function(){return new Promise(function(resolve){resolve(getSupport())})},each:each,get:get,set:set,remove:remove,clear:clear,size:size,key:key,keys:keys};this.sessionStorageDriver=sessionStorageDriver,window.sessionStorageDriver=sessionStorageDriver}}.call(window),function(self){$(function(){function transformProperty(){for(var style,ret,styles=["webkitTransform","MozTransform","msTransform","transform"],el=document.createElement("p"),i=0;i<styles.length;i++)if(style=styles[i],null!==el.style[style]){ret=style;break}return ret}function hasTranslate3d(){var prop=transformProperty(),map={webkitTransform:"-webkit-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"},el=document.createElement("div");el.style[prop]="translate3d(1px,1px,1px)",document.body.insertBefore(el,null);var val=getComputedStyle(el).getPropertyValue(map[prop]);return document.body.removeChild(el),null!==val&&val.length&&"none"!=val}function hasTransitions(){var styl=document.body.style;return"transition"in styl||"webkitTransition"in styl||"MozTransition"in styl||"msTransition"in styl}function componentEvents(){var bind="addEventListener",unbind="removeEventListener",prefix="addEventListener"!==bind?"on":"";return{bind:function(el,type,fn,capture){return el[bind](prefix+type,fn,capture||!1),fn},unbind:function(el,type,fn,capture){return el[unbind](prefix+type,fn,capture||!1),fn}}}function cssEmitter(){function CssEmitter(element){return this instanceof CssEmitter?void(this.el=element):new CssEmitter(element)}var events=componentEvents(),watch=["transitionend","webkitTransitionEnd","MSTransitionEnd","animationend","webkitAnimationEnd","MSAnimationEnd"];return CssEmitter.prototype.bind=function(fn){for(var i=0;i<watch.length;i++)events.bind(this.el,watch[i],fn);return this},CssEmitter.prototype.unbind=function(fn){for(var i=0;i<watch.length;i++)events.unbind(this.el,watch[i],fn);return this},CssEmitter.prototype.once=function(fn){function on(){self.unbind(on),fn.apply(self.el,arguments)}var self=this;return self.bind(on),this},CssEmitter}function yieldsAafterTransition(){function after(el,fn){return supported&&has(el)?(emitter(el).bind(fn),fn):fn()}var has=hasTransitions,emitter=cssEmitter(),supported=has(),n=0,global=function(){return this}(),once=function(fn){function once(){if(this==global){if(once.called)return;return once.called=!0,fn.apply(this,arguments)}var key="__called_"+id+"__";if(!this[key])return this[key]=!0,fn.apply(this,arguments)}var id=n++;return once};return after.once=function(el,fn){var callback=once(fn);after(el,fn=function(){emitter(el).unbind(fn),callback()})},after}function emitter(){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}return Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){this.off(event,on),fn.apply(this,arguments)}return on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0===arguments.length)return this._callbacks={},this;var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks["$"+event],this;for(var cb,i=0;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks["$"+event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length},Emitter}function cssEase(){return{"in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)","ease-in-quad":"cubic-bezier(0.550, 0.085, 0.680, 0.530)","ease-out-quad":"cubic-bezier(0.250, 0.460, 0.450, 0.940)","ease-in-out-quad":"cubic-bezier(0.455, 0.030, 0.515, 0.955)","ease-in-cubic":"cubic-bezier(0.550, 0.055, 0.675, 0.190)","ease-out-cubic":"cubic-bezier(0.215, 0.610, 0.355, 1.000)","ease-in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1.000)","ease-in-quart":"cubic-bezier(0.895, 0.030, 0.685, 0.220)","ease-out-quart":"cubic-bezier(0.165, 0.840, 0.440, 1.000)","ease-in-out-quart":"cubic-bezier(0.770, 0.000, 0.175, 1.000)","ease-in-quint":"cubic-bezier(0.755, 0.050, 0.855, 0.060)","ease-out-quint":"cubic-bezier(0.230, 1.000, 0.320, 1.000)","ease-in-out-quint":"cubic-bezier(0.860, 0.000, 0.070, 1.000)","ease-in-sine":"cubic-bezier(0.470, 0.000, 0.745, 0.715)","ease-out-sine":"cubic-bezier(0.390, 0.575, 0.565, 1.000)","ease-in-out-sine":"cubic-bezier(0.445, 0.050, 0.550, 0.950)","ease-in-expo":"cubic-bezier(0.950, 0.050, 0.795, 0.035)","ease-out-expo":"cubic-bezier(0.190, 1.000, 0.220, 1.000)","ease-in-out-expo":"cubic-bezier(1.000, 0.000, 0.000, 1.000)","ease-out-in-back":"cubic-bezier(0,1,1,0)","ease-in-circ":"cubic-bezier(0.600, 0.040, 0.980, 0.335)","ease-out-circ":"cubic-bezier(0.075, 0.820, 0.165, 1.000)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.150, 0.860)","ease-out-in-circ":"cubic-bezier((0.135, 0.885, 0.860, 0.140)","ease-in-back":"cubic-bezier(0.600, -0.280, 0.735, 0.045)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.320, 1.275)","ease-in-out-back":"cubic-bezier(0.680, -0.550, 0.265, 1.550)"}}$.extend({anim:function(){function Anim(el){if(!(this instanceof Anim))return new Anim(el);if("string"==typeof el&&(el=query(el)),!el)throw new TypeError("Anim must be initialized with element or selector");this.el=el,this._props={},this._rotate=0,this._transitionProps=[],this._transforms=[],this.duration(Anim.defaults.duration),requestAnimationFrame(Anim)}var Emitter=emitter(),query=function(selector){return document.querySelector(selector)},after=yieldsAafterTransition(),has3d=hasTranslate3d(),ease=cssEase(),translate=has3d?["translate3d(",", 0)"]:["translate(",")"],style=window.getComputedStyle||window.currentStyle;return Anim.ease=ease,Anim.defaults={duration:500},Anim.select=function(selector){return $(selector)[0]},Emitter(Anim.prototype),Anim.prototype.transform=function(transform){return this._transforms.push(transform),this},Anim.prototype.skew=function(x,y){return this.transform("skew("+x+"deg, "+(y||0)+"deg)")},Anim.prototype.skewX=function(n){return this.transform("skewX("+n+"deg)")},Anim.prototype.skewY=function(n){return this.transform("skewY("+n+"deg)")},Anim.prototype.translate=Anim.prototype.to=function(x,y){
return this.transform(translate.join(""+x+"px, "+(y||0)+"px"))},Anim.prototype.translateX=Anim.prototype.x=function(n){return this.transform("translateX("+n+"px)")},Anim.prototype.translateY=Anim.prototype.y=function(n){return this.transform("translateY("+n+"px)")},Anim.prototype.scale=function(x,y){return this.transform("scale("+x+", "+(y||x)+")")},Anim.prototype.scaleX=function(n){return this.transform("scaleX("+n+")")},Anim.prototype.scaleY=function(n){return this.transform("scaleY("+n+")")},Anim.prototype.matrix=function(m11,m12,m21,m22,m31,m32){return this.transform("matrix("+[m11,m12,m21,m22,m31,m32].join(",")+")")},Anim.prototype.rotate=function(n){return this.transform("rotate("+n+"deg)")},Anim.prototype.ease=function(fn){return fn=ease[fn]||fn||"ease",this.setVendorProperty("transition-timing-function",fn)},Anim.prototype.animate=function(name,props){for(var i in props)props.hasOwnProperty(i)&&this.setVendorProperty("animation-"+i,props[i]);return this.setVendorProperty("animation-name",name)},Anim.prototype.duration=function(n){return n=this._duration="string"==typeof n?1e3*parseFloat(n):n,this.setVendorProperty("transition-duration",n+"ms")},Anim.prototype.delay=function(n){return n="string"==typeof n?1e3*parseFloat(n):n,this.setVendorProperty("transition-delay",n+"ms")},Anim.prototype.setProperty=function(prop,val){return this._props[prop]=val,this},Anim.prototype.setVendorProperty=function(prop,val){return this.setProperty("-webkit-"+prop,val),this.setProperty("-moz-"+prop,val),this.setProperty("-ms-"+prop,val),this},Anim.prototype.set=function(prop,val){return this.transition(prop),this._props[prop]=val,this},Anim.prototype.add=function(prop,val){if(style){var self=this;return this.on("start",function(){var curr=parseInt(self.current(prop),10);self.set(prop,curr+val+"px")})}},Anim.prototype.sub=function(prop,val){if(style){var self=this;return this.on("start",function(){var curr=parseInt(self.current(prop),10);self.set(prop,curr-val+"px")})}},Anim.prototype.current=function(prop){return style(this.el).getPropertyValue(prop)},Anim.prototype.transition=function(prop){return this._transitionProps.indexOf(prop)?(this._transitionProps.push(prop),this):this},Anim.prototype.applyProperties=function(){for(var prop in this._props)this.el.style.setProperty(prop,this._props[prop],"");return this},Anim.prototype.anim=Anim.prototype.select=function(selector){return this.el=Anim.select(selector),this},Anim.prototype.then=function(fn){if(fn instanceof Anim)this.on("end",function(){fn.run()});else{if("function"!=typeof fn){var clone=new Anim(this.el);return clone._transforms=this._transforms.slice(0),this.then(clone),clone.parent=this,clone}this.on("end",fn)}return this},Anim.prototype.pop=function(){return this.parent},Anim.prototype.reset=function(){return this.el.style.webkitTransitionDuration=this.el.style.mozTransitionDuration=this.el.style.msTransitionDuration=this.el.style.oTransitionDuration="",this},Anim.prototype.run=function(fn){var self=this;return this.emit("start"),this._transforms.length&&this.setVendorProperty("transform",this._transforms.join(" ")),this.setVendorProperty("transition-properties",this._transitionProps.join(", ")),this.applyProperties(),fn&&this.then(fn),after.once(this.el,function(){self.reset(),self.emit("end")}),this},Anim}()})})}(window),function(){"use strict";$.extend({mixin:function(sourceObj,targetObj){for(var key in sourceObj)key in targetObj||(targetObj[key]=sourceObj[key]);return targetObj},clone:function(obj){return"function"!=typeof Object.create&&(Object.create=function(){function Temp(){}var hasOwn=Object.prototype.hasOwnProperty;return function(O){if("object"!=typeof O)throw TypeError("Object prototype may only be an Object or null");Temp.prototype=O;var obj=new Temp;if(Temp.prototype=null,arguments.length>1){var Properties=Object(arguments[1]);for(var prop in Properties)hasOwn.call(Properties,prop)&&(obj[prop]=Properties[prop])}return obj}}()),Object.create(obj)},Modules:function(){function add(name,dependencies,implementation){"function"!==$.type(dependencies)||implementation||(implementation=dependencies,dependencies=[]);for(var depLen=dependencies.length,i=0;depLen>i;i++)dependencies[i]=modules[dependencies[i]];modules[name]=implementation.apply(implementation,dependencies)}function run(name){return modules[name]}function remove(module){delete modules[module]}var modules={};return{add:add,run:run,remove:remove}}()})}(),function(){$(function(){"use strict";$.extend({AdjustNavbarLayout:function(screen){function handleOneSibling(sib){var sibling=sib||h1.siblings();amount=sibling[0].clientWidth,sibling.is(":first-child")?(whichSide="margin-right",oppositeSide="margin-left",rtl&&(whichSide="margin-left",oppositeSide="margin-right")):sibling.is(":last-child")&&(whichSide="margin-left",oppositeSide="margin-right",rtl&&(whichSide="margin-right",oppositeSide="margin-left"))}if($("link[href*=ios]")[0]){screen=$(screen);var whichSide,oppositeSide,visibleSibling,h1=screen.find("h1"),siblings=h1.siblings(),rtl="rtl"===$("html").attr("dir"),amount=0,hidden=!1,calculateLongest=function(a,b){var widthA=a[0].clientWidth,widthB=b[0].clientWidth;widthA||(widthA=0,whichSide="margin-right",oppositeSide="margin-left",rtl&&(whichSide="margin-left",oppositeSide="margin-right")),widthB||(widthB=0,whichSide="margin-left",oppositeSide="margin-right",rtl&&(whichSide="margin-right",oppositeSide="margin-left")),widthB>widthA?(whichSide="margin-left",oppositeSide="margin-right",rtl&&(whichSide="margin-right",oppositeSide="margin-left"),amount=widthB-widthA):widthA>widthB?(whichSide="margin-right",oppositeSide="margin-left",rtl&&(whichSide="margin-left",oppositeSide="margin-right"),amount=widthA-widthB):amount=0};1===siblings.length?handleOneSibling():2===siblings.length?(siblings.forEach(function(item){"none"===$(item).css("display")?hidden=!0:visibleSibling=$(item)}),hidden?handleOneSibling(visibleSibling):calculateLongest(siblings.eq(0),siblings.eq(1))):(whichSide="margin-left",oppositeSide="margin-right",amount=0);var props={};props[whichSide]=amount;var sibwidth=0;siblings.size()&&siblings.forEach(function(item){sibwidth+=$(item)[0].clientWidth});var headerWidth=screen.find("nav").width()/2;sibwidth+20>headerWidth?h1.css({"margin-left":0,"margin-right":0}):h1.css(props)}}}),setTimeout(function(){$("screen").forEach(function(screen){$.AdjustNavbarLayout(screen)})})})}(),function(){"use strict";$(function(){/(mobile)|(ios)|(android)/gim.test(navigator.userAgent)||$("body").addClass("isDesktop"),$("link[href*=ios]")[0]?($("body").addClass("isiOS"),$.AdjustNavbarLayout()):$("link[href*=android]")[0]?$("body").addClass("isAndroid"):$("link[href*=windows]")[0]&&$("body").addClass("isWindows")})}(),function(){var truckBackButtonSVG='<svg id="truck-back-button-svg" width="100px" height="100px" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="truck-back-arrow" stroke="#979797"><path d="M50.7822487,4.05872022 L5.60302012,49.1913445 L50.4625593,94.6779982" id="back-arrow-bracket"></path><path d="M6,49.368351 L95.8300018,49.368351" id="back-arrow-shaft"></path></g></g></svg>';$.fn.extend({decorateBackButton:function(){($(this).hasClass("back")||$(this).hasClass("backTo"))&&this.forEach(function(button){var temp=$(button).text();$(button).html("<span>"+temp+"</span>"),$(button).prepend(truckBackButtonSVG)})}}),$(function(){$(".back").decorateBackButton(),$(".backTo").decorateBackButton()})}(),function(){$(function(){var isNavigating=!1,getScreen=function(screen){return $("#"+screen)},makeScreenCurrent=function(screen){screen=$(screen),screen.addClass("current"),screen.removeClass("previous"),screen.removeClass("next")},makeScreenPrevious=function(screen){screen=$(screen),screen.removeClass("current"),screen.removeClass("next"),screen.addClass("previous")},makeScreenNext=function(screen){screen=$(screen),screen.removeClass("current"),screen.removeClass("previous"),screen.addClass("next")};$.extend({GoToScreen:function(destination){if(!isNavigating){isNavigating=!0,$.TruckRoutes.push(destination);var currentScreen=$.screens.getCurrent(),destinationScreen=function(){var temp,regex=/:/gim;return temp=regex.test(destination)?destination.split(":")[0]:destination,getScreen(temp)}();currentScreen[0]&&(currentScreen[0].scrollTop=0),destinationScreen[0]&&(destinationScreen[0].scrollTop=0),makeScreenPrevious(currentScreen),makeScreenCurrent(destinationScreen),$.Router.dispatch(destination),setTimeout(function(){isNavigating=!1},500)}},GoBack:function(){var currentScreen=$.screens.getCurrent();$.TruckRoutes.pop();var desintation=$.TruckRoutes.eq(-1),dest=$.TruckRoutes.eq(-1).split(":")[0],destinationScreen=getScreen(dest);0===$.TruckRoutes.size()&&(dest=$.screens.eq(0),$.TruckRoutes.push(dest[0].id)),currentScreen[0]&&(currentScreen[0].scrollTop=0),destinationScreen[0]&&(destinationScreen[0].scrollTop=0),$.Router.dispatch(desintation),makeScreenNext(currentScreen),makeScreenCurrent(destinationScreen),1===$.TruckRoutes.size()},isNavigating:!1,GoBackToScreen:function(destination){for(var temp,position=$.TruckRoutes.index(destination),destinationScreen=getScreen(destination);$.TruckRoutes.size()>position+1;)temp=$.TruckRoutes.pop(),temp=getScreen(temp),makeScreenNext(temp);makeScreenCurrent(destinationScreen),$.Router.dispatch(destination)}}),$("body").on("tap",".back",function(){this.hasAttribute("disabled")||$.GoBack()});var handleNavigationEvent=function(element){if(element=$(element),!$.isNavigating&&element.hazAttr("data-goto")[0]&&!element.closest("ul").is(".deletable")){var destination=element.attr("data-goto");destination&&(element.addClass("selected"),setTimeout(function(){element.removeClass("selected")},1e3),$.isAndroid||$.isChrome?setTimeout(function(){$.GoToScreen(destination)},200):$.GoToScreen(destination))}};$("body").on("tap","li",function(){handleNavigationEvent($(this))}),$("body").on("doubletap","li",function(){$.isNavigating||handleNavigationEvent($(this))})})}(),function(){"use strict";$.extend({TabBar:function(options){if(options){var id=$.uuid(),settings={selected:0};$.extend(settings,options),settings.icons.length||(settings.icons=settings.labels),settings.id?id=settings.id:settings.id=id;var __tabbarScreens=$(),screens=$(),screenPrefix="#";settings.screens?settings.screens.forEach(function(screen){/screenPrefix/gim.test(screen)?(__tabbarScreens.concat($(screen)[0]),$(screen).addClass("tabScreen")):(__tabbarScreens.push($(screenPrefix+screen)[0]),$(screenPrefix+screen).addClass("tabScreen"))}):settings.labels.forEach(function(screen,idx){__tabbarScreens.push(screens.eq(idx))});var selectedScreen,showIcons=settings.showIcons?' class="showIcons" ':"",setToCurrent=function(element){$(element).removeClass("previous").removeClass("next").addClass("current"),$(element).attr("aria-hidden","false")},setToNext=function(element){$(element).removeClass("current").addClass("next"),$(element).attr("aria-hidden","true")},makeTab=function(label,icon,idx){var tab='<button role="tab" class="'+icon;return settings.selected===idx&&(tab+=" selected"),tab+='"',settings.screens&&settings.screens.length&&(tab+=' data-id="'+settings.screens[idx]+'"'),tab+='><span class="icon"></span><label>'+settings.labels[idx]+"</label></button>"},tabbarTmpl=$('<tabbar role="tabpanel"'+showIcons+"></tabbar>");tabbarTmpl[0].id=settings.id,tabbarTmpl.addClass("tabbar"),setToNext($("screen")),selectedScreen=$("screen").eq(settings.selected),setToCurrent(selectedScreen),settings.labels.length&&settings.labels.forEach(function(label,idx){tabbarTmpl.append(makeTab(label,settings.icons[idx],idx))}),$("body").prepend(tabbarTmpl);var tabbar=$("#"+settings.id),__tabbarButtons=tabbar.find("button"),__selectedTabbarButton=__tabbarButtons.eq(settings.selected),__selectedTabbarScreen=__tabbarScreens.eq(settings.selected);return $(function(){$.TruckRoutes.purge(),$.TruckRoutes.push(__tabbarScreens.eq(settings.selected)[0].id);var tabbarButtons=tabbar.find("button");$.Router.dispatch(__selectedTabbarScreen[0].id),tabbarButtons.forEach(function(button,idx){$(button).data("truck-route",__tabbarScreens.eq(idx)[0].id)}),tabbar.on("tap","button",function(){var routes=$(this).data("truck-route").split("/"),fullRoute=$.TruckRoutes.getFullRoute();if(routes.length>1){__tabbarButtons.hazClass("selected").data("truck-route",fullRoute),__tabbarButtons.hazClass("selected").removeClass("selected").addClass("next"),$(this).addClass("selected"),$("screens").removeClass("current").addClass("next").attr("aria-hidden",!0),$("screens").removeClass("previous").addClass("next").attr("aria-hidden",!0);var navRoutesFull=$(this).data("truck-route"),navRoutes=navRoutesFull.split("/");navRoutes.forEach(function(route,idx){var routing=route.split(":"),whichRoute=routing[0];idx!==routes.length-1?$("#"+whichRoute).removeClass("next").addClass("previous").attr("aria-hidden",!0):$("#"+whichRoute).removeClass("next").addClass("current").attr("aria-hidden",!1)}),$.TruckRoutes.purge(),$.TruckRoutes.concat(navRoutes),$.Router.dispatch(routes[routes.length-1])}else __tabbarButtons.hazClass("selected").data("truck-route",fullRoute),__tabbarButtons.hazClass("selected").removeClass("selected").addClass("next"),$("screen").removeClass("current").addClass("next").attr("aria-hidden",!0),$("screen").removeClass("previous").addClass("next").attr("aria-hidden",!0),$(this).addClass("selected"),$.screens.eq($(this).index()).removeClass("next").removeClass("previous").addClass("current").attr("aria-hidden",!1),$.TruckRoutes.purge(),$.TruckRoutes.concat(routes),$.Router.dispatch(fullRoute)})}),{getSelectedTab:function(){return __selectedTabbarButton},getSelectedScreen:function(){return __selectedTabbarScreen},setSelectedTab:function(position){tabbar.find("button").iz(".selected").removeClass("selected").addClass("next"),tabbar.children("button").eq(position).addClass("selected"),setToNext(__tabbarScreens.iz(".current")[0]),setToCurrent(__tabbarScreens.eq(position)[0])}}}}})}(),function(){"use strict";$.extend({SlideOut:function(){var slideOutButton=$('<button class="slide-out-button"></button>'),slideOut="<slideout><section></section></slideout>";$("body").prepend(slideOut),$("body").append(slideOutButton);var slideout=$("slideout"),slideOutBtn=$("button.slide-out-button");return slideout.attr("aria-hidden",!0),$("screens").attr("aria-hidden",!0),$("screens").eq(0).addClass("show").attr("aria-hidden","false"),slideOutBtn.on("tap",function(){$(this).toggleClass("focused"),slideout.hasClass("open")?(slideout.removeClass("open"),slideout.removeAttr("aria-hidden"),$("button.back").removeClass("disabled").removeProp("disabled"),$("button.backTo").removeClass("disabled").removeProp("disabled")):(slideout.addClass("open"),slideout.attr("aria-hidden",!0),$("button.back").addClass("disabled").prop("disabled",!0),$("button.backTo").addClass("disabled").prop("disabled",!0))}),$("slideout").on("tap","li",function(){var menuItems=slideout.find("li[data-show]");slideout.attr("aria-hidden","true"),slideOutBtn.toggleClass("focused"),$("button.back").removeClass("disabled").removeProp("disabled"),$("button.backTo").removeClass("disabled").removeProp("disabled"),menuItems.hazClass("selected").removeClass("selected"),$.screens.hazClass("show").removeClass("show").attr("aria-hidden",!0);var screenToShow=$(this).attr("data-show");$("#"+screenToShow.split(":")[0]).addClass("show").attr("aria-hidden",!1),$("screen.current").addClass("next").removeClass("current"),$("screen.previous").addClass("next").removeClass("previous"),$.Router.dispatch(screenToShow),slideout.removeClass("open")}),{populate:function(options){var slideout=$("slideout");if(slideout[0]&&options){slideout.find("section").append('<ul class="list"></ul>');var list=slideout.find("ul");options.forEach(function(ctx){for(var key in ctx)"header"===key?list.append('<li class="menu-header"><h2>'+ctx[key]+"</h2></li>"):list.append('<li data-show="'+key+'"><h3>'+ctx[key]+"</h3></li>")}),slideout.find("li").eq(0).addClass("selected")}}}}})}(),function(){"use strict";$.extend({EditList:function(options){var settings={editLabel:"Edit",doneLabel:"Done",deleteLabel:"Delete",cancelLabel:"Cancel",callback:$.noop,deletable:!0,movable:!0,model:void 0,modelProp:"id",view:void 0},__data=[];if(options){$.extend(settings,options);var __model=settings.model||!1;if(settings.deletable||settings.movable){var __view=settings.view;options&&$.extend(settings,options);var deleteButton,editButton,deletionIndicator,button,moveUpIndicator,moveDownIndicator,deleteLabel,dispelDeletable="swiperight",enableDeletable="swipeleft",element=settings.element,dir=$("html").attr("dir");dir=dir?dir.toLowerCase():"","rtl"===dir&&(dispelDeletable="swipeleft",enableDeletable="swiperight"),$("link[href*=windows]")[0]&&(deleteLabel=""),settings.deletable&&(deleteButton=$.concat('<button class="delete"><label>',settings.deleteLabel,'</label><svg width="27px" height="30px" viewBox="0 0 27 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="delete-icon" fill="#3A3A3A"><g transform="translate(3.000000, 1.000000)"><path d="M1,6 L20,6 L20,24.9986131 C20,26.6562333 18.6639569,28 16.9998779,28 L4.00012207,28 C2.3432004,28 1,26.6569187 1,24.9986131 L1,6 Z M4,9 L5,9 L5,25 L4,25 L4,9 Z M8,9 L9,9 L9,25 L8,25 L8,9 Z M12,9 L13,9 L13,25 L12,25 L12,9 Z M16,9 L17,9 L17,25 L16,25 L16,9 Z" id="can"></path><path d="M0,4.96611425 L0,1.67759301 L5.1776507,1.7511163 L6.482399,0 L14.5847825,0 L15.8789491,1.7511163 L21,1.7511163 L21,4.9447157 L0,4.96611425 L0,4.96611425 Z" id="lid"></path></g></g></g></svg></button>'),deletionIndicator='<span class="deletion-indicator"><svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="deletion-indicator"><g id="ios-indicator"><circle id="ios-circle" fill="#FF0000" cx="10" cy="10" r="10"></circle><path d="M3.5,10 L16.5,10" id="ios-bar" stroke="#FFFFFF" stroke-width="2" stroke-linecap="square"></path></g><path d="M2,13 L9.9294326,16.8406135 L17.1937075,1.90173332" id="checkmark" stroke="#FA0303" stroke-width="2"></path></g></g></svg></span>',$(element).addClass("deletable")),settings.movable&&(moveUpIndicator='<span class=\'move-up\'><svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="move-indicator"><circle id="circle" cx="11" cy="11" r="10"></circle><path d="M4,13.9645823 L10.9316382,5.94630319 L17.795297,13.9073417" id="move-up"></path></g></g></svg></span>',moveDownIndicator='<span class=\'move-down\'><svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="move-indicator"><circle id="circle" cx="11" cy="11" r="10"></circle><path d="M4.0421421,7.98172087 L10.912246,16 L17.7960071,8.1103389" id="move-down"></path></g></g></svg></span>',$(element).addClass("editable")),editButton=$.concat('<button class="edit">',settings.editLabel,"</button>");var nav=$(element).closest("screen").find("nav");nav.append(editButton),nav.find(".back").hide(),nav.prepend('<button class="cancel">'+settings.cancelLabel+"</button>"),nav.find(".cancel").hide(),$.AdjustNavbarLayout($(element).closest("screen")),button=$(element).closest("screen").find(".edit"),$(element).find("li").forEach(function(ctx){$(ctx).has(".deletion-indicator").length||(settings.deletable&&$(ctx).prepend(deletionIndicator),settings.movable&&($(ctx).append(moveDownIndicator),$(ctx).append(moveUpIndicator)),settings.deletable&&$(ctx).append(deleteButton))});var setupDeletability=function(callback,list,button){$(function(){if(__view){var temp=$("<div></div>");temp[0].insertAdjacentHTML("afterbegin",__view.getTemplate()),temp.find("li").prepend(deletionIndicator),temp.find("li").append(moveDownIndicator),temp.find("li").append(moveUpIndicator);var template=temp.html();__view.setTemplate(template)}button.on("tap",function(){var $this=this;if(this.classList.contains("edit"))setTimeout(function(){$this.classList.remove("edit"),$this.classList.add("done"),$($this).text(settings.doneLabel),$(list).addClass("showIndicators"),$($this).siblings(".back").hide(),$($this).siblings(".cancel").show()});else if(this.classList.contains("done")){$(list).data("list-edit")&&callback.call(callback,list),setTimeout(function(){$this.classList.remove("done"),$this.classList.add("edit"),$($this).text(settings.editLabel),$(list).removeClass("showIndicators"),$(list).find("li").removeClass("selected"),$($this).siblings(".cancel").hide()});if($(list).find("li").forEach(function(ctx,idx){__data.push($(ctx).attr("data-id"))}),__model){var __newarray=[];__data.filter(function(item){var ret=__model.filter(function(b){return b[settings.modelProp]===item});__newarray.push(ret[0])}),__data=[],__model.purge(),__model.concat(__newarray,!0),__newarray=[]}}setTimeout(function(){$.AdjustNavbarLayout($(element).closest("screen"))})}),$(list).off("tap",".deletion-indicator"),$(list).on("tap",".deletion-indicator",function(){return $(this).closest("li").hasClass("selected")?void $(this).closest("li").removeClass("selected"):void $(this).closest("li").addClass("selected")}),$(list).on(dispelDeletable,"li",function(){settings.deletable&&$(this).removeClass("selected")}),$(list).on(enableDeletable,"li",function(){settings.deletable&&$(this).addClass("selected")}),$(list).on("tap",".move-up",function(e){var item=$(this).closest("li");if(!item.is("li:first-child")){$(list).data("list-edit",!0),item=$(this).closest("li");var prev=item.prev(),itemClone=item.clone(),prevClone=prev.clone(),height=item[0].offsetHeight;item.css({"-webkit-transform":"translate3d(0,-"+height+"px,0)",transform:"translate3d(0,-"+height+"px,0)"}),prev.css({"-webkit-transform":"translate3d(0,"+height+"px,0)",transform:"translate3d(0,"+height+"px,0)"}),setTimeout(function(){$.replace(prevClone,item),$.replace(itemClone,prev)},250)}}),$(list).on("tap",".move-down",function(e){var item=$(this).closest("li"),next=item.next();if(!item.is("li:last-child")){var itemClone=item.clone(),nextClone=next.clone();$(list).data("list-edit",!0);var height=item[0].offsetHeight;item.css({"-webkit-transform":"translate3d(0,"+height+"px,0)",transform:"translate3d(0,"+height+"px,0)"}),next.css({"-webkit-transform":"translate3d(0,-"+height+"px,0)",transform:"translate3d(0,-"+height+"px,0)"}),setTimeout(function(){$.replace(nextClone,item),$.replace(itemClone,next)},250)}}),$(list).on("tap",".delete",function(){var listItem=$(this).parent();$(list).data("list-edit",!0);var direction="-1200%";"rtl"===$("html").attr("dir")&&(direction="1000%"),$(this).siblings().css({"-webkit-transform":"translate3d("+direction+",0,0)","-webkit-transition":"all 1s ease-out",transform:"translate3d("+direction+",0,0)",transition:"all 1s ease-out"}),setTimeout(function(){listItem.remove()},500)}),nav.find(".cancel").on("tap",function(){nav.find(".back").show(),$(this).hide(),__view.render(),nav.find(".done").addClass("edit").removeClass("done"),$(list).removeClass("showIndicators"),$(list).find("li").removeClass("selected"),$(this).hide()})})};return setupDeletability(settings.callback,element,button),{getModel:function(){return __model},getView:function(){return __view}}}}}})}(),function(){"use strict";$.extend({Form:function(options){function validateElement(item){__passed?convertToObject($(item.element).attr("name"),$(item.element).val()):(__errors.push({element:item.element,type:item.type}),item.callback&&item.callback())}function convertToObject(name,value){__result.push({name:name,value:value})}function convertObjectToJSON(data){var delimiter="_",result={},arrays={};return data.forEach(function(item){var value=item.value;if(""!==value)for(var name=item.name,nameParts=name.split(delimiter),currResult=result,j=0;j<nameParts.length;j++){var arrName,namePart=nameParts[j];if(namePart.indexOf("[]")>-1&&j===nameParts.length-1)arrName=namePart.substr(0,namePart.indexOf("[")),currResult[arrName]||(currResult[arrName]=[]),currResult[arrName].push(value);else if(namePart.indexOf("[")>-1){arrName=namePart.substr(0,namePart.indexOf("["));var arrIdx=namePart.replace(/^[a-z]+\[|\]$/gi,"");arrays[arrName]||(arrays[arrName]={}),currResult[arrName]||(currResult[arrName]=[]),j===nameParts.length-1?currResult[arrName].push(value):arrays[arrName][arrIdx]||(currResult[arrName].push({}),arrays[arrName][arrIdx]=currResult[arrName][currResult[arrName].length-1]),currResult=arrays[arrName][arrIdx]}else j<nameParts.length-1?(currResult[namePart]||(currResult[namePart]={}),currResult=currResult[namePart]):currResult[namePart]=value}}),result}if(options&&"array"===$.type(options)){var __passed=!1,__errors=[],__result=[];return options.forEach(function(item){switch(item.type){case"notempty":return __passed=validateElement(item.element,item.type),void __errors.push({element:item.element,type:item.type});case"number":return __passed=$(item.element).validateNumber(),void validateElement(item);case"text":return __passed=$(item.element).validateAlphabetic(),void validateElement(item);case"alphanumeric":return __passed=$(item.element).validateAlphaNumeric(),void validateElement(item);case"username":return __passed=$(item.element).validateUserName(item.min),void validateElement(item);case"email":return __passed=$(item.element).validateEmail(),void validateElement(item);case"phone":return __passed=$(item.element).validatePhoneNumber(),void validateElement(item);case"url":return __passed=$(item.element).validateUrl(),void validateElement(item);case"age":return __passed=$(item.element).validateAge(item.min),void validateElement(item);case"checkbox":return __passed=$(item.element).validateCheckbox(),void(__passed&&validateElement(item));case"radio":return __passed=$(item.element).validateRadioButtons(),void validateElement(item);case"selectbox":return __passed=$(item.element).validateSelectBox(),void validateElement(item);case"password":return __passed=$.validatePassword(item.element,item.element2,item.min),void __errors.push({element:item.element,element2:item.element2,type:item.type});case"switch":return __passed=$(item.element).validateSwitch(),void(__passed&&validateElement(item));case"selectlist":__passed=$(item.element).validateSelectList(),__passed&&validateElement(item);case"multiselectlist":__passed=$(item.element).validateMultiSelectList();var inputs;__passed&&(inputs=$(item.element).find("input[type=checkbox]"),inputs.forEach(function(item){item.checked&&convertToObject(item.name,item.value)}))}if(item.type.match(/custom/)){var cv=$.customValidators.filter(function(validator){return validator.name===item.type});if(cv){var result=$.validateWithRegex(item.element,cv[0].regex);if(result){var el=$(item.element);convertToObject(el[0].name,el[0].value)}else __errors.push({element:item.element,type:item.type}),item.callback&&item.callback()}}}),{getErrors:function(){return __errors.length?__errors:void 0},errors:function(){return __errors.length?!0:void 0},get:function(){return convertObjectToJSON(__result)}}}}})}(),function(){"use strict";$.extend({SelectList:function(options){if(options&&options.element){var settings={element:void 0,selected:void 0,name:$.uuid(),callback:$.noop,model:void 0},__selection={};$.extend(settings,options);var name=settings.name,list=$(settings.element);return list.addClass("select-list"),list.find("li").forEach(function(ctx,idx){var value=null!==ctx.getAttribute("data-select")?ctx.getAttribute("data-select"):"";ctx.setAttribute("role","radio"),$(ctx).removeClass("selected").find("input").removeAttr("checked"),$(ctx).append('<span class="selection-indicator"><svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="selection-indicator"><path d="M2,13 L9.9294326,16.8406135 L17.1937075,1.90173332" id="checkmark" stroke="#007AFF" stroke-width="2"></path><circle id="outer-circle" stroke="#007AFF" stroke-width="2" cx="10" cy="10" r="9"></circle><circle id="inner-circle" fill="#007AFF" cx="10" cy="10" r="4"></circle></g></g></svg></span>'),settings.selected===idx?(ctx.setAttribute("aria-checked","true"),ctx.classList.add("selected"),$(ctx).find("input")[0]?$(ctx).find("input").prop("checked",!0).attr("value",value):$(ctx).append('<input type="radio" checked="checked" name="'+name+'" value="'+value+'">'),__selection={index:settings.selected,value:value}):$(ctx).find("input")[0]||$(ctx).append('<input type="radio" name="'+name+'" value="'+value+'">')}),list.on("tap","li",function(){var item=$(this);__selection={index:item.index(),value:item.find("input").val()},item.siblings("li").removeClass("selected"),item.siblings("li").removeAttr("aria-checked"),item.siblings("li").find("input").removeProp("checked"),item.addClass("selected"),item.attr("aria-checked",!0),item.find("input").prop("checked",!0),settings.callback.apply(this,arguments)}),{getSelection:function(){return __selection}}}}})}(),function(){"use strict";$.extend({MultiSelectList:function(options){if(options&&options.element){var settings={element:void 0,selected:[],name:$.uuid(),callback:$.noop,model:void 0},__selection=$.Stack();$.extend(settings,options);var selections=settings.selected,name=settings.name,list=$(settings.element);return list.addClass("multi-select-list"),list.find("li").forEach(function(ctx,idx){var value=null!==ctx.getAttribute("data-select")?ctx.getAttribute("data-select"):"";selections.forEach(function(item){item.index===idx&&__selection.push({index:idx,value:value})}),ctx.setAttribute("role","checkbox"),$(ctx).removeClass("selected").find("input").removeAttr("checked"),$(ctx).prepend('<span class="multi-selection-indicator"><svg width="30px" height="30px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="multi-select-icon" stroke="#979797"><g id="multi-select-circle-+-mulit-select-checkmark" transform="translate(2.000000, 2.000000)"><circle id="multi-select-circle" cx="13" cy="13" r="13"></circle><path d="M4.71521456,15.9877529 L13.0000002,20.7028494 L19.977049,5.70284941" id="mulit-select-checkmark"></path></g></g></g></svg></span>'),$(ctx).append('<input type="checkbox" name="'+name+'" value="'+value+'">'),selections.length&&selections.forEach(function(sel){sel===idx&&(ctx.setAttribute("aria-checked","true"),ctx.classList.add("selected"),$(ctx).find("input").prop("checked",!0).attr("value",value),__selection.push({index:sel,value:value}))})}),list.on("tap","li",function(){var item=$(this);if(item.hasClass("selected")){item.removeClass("selected").removeAttr("aria-checked"),item.find("input").removeProp("checked");var pos,dataObj={index:item.index(),value:item.attr("data-select")};__selection.forEach(function(item,idx){item.index===dataObj.index&&item.value===dataObj.value&&(pos=idx)}),__selection.splice(pos,1),settings.callback.apply(this,arguments)}else __selection.push({index:item.index(),value:item.attr("data-select")}),__selection.unique(),item.addClass("selected"),item.attr("aria-checked",!0),item.find("input").prop("checked",!0),settings.callback.apply(this,arguments)}),{getSelection:function(){return __selection.getData()}}}}})}(),function(){"use strict";$.extend({Switch:function(options){if(options&&options.element){var __checked=!1,settings={element:void 0,
name:void 0,value:void 0,checked:!1,onCallback:$.noop,offCallback:$.noop};$.extend(settings,options);var __selection={checked:__checked,value:settings.value},__element=$(settings.element);__checked=settings.checked;var swipeOn="swiperight",swipeOff="swipeleft";"rtl"===document.documentElement.dir&&(swipeOn="swipeleft",swipeOff="swiperight");var checkState=settings.checked?" checked":"",__switch=$.concat("<em></em>",'<input type="checkbox" name="',settings.name,'"',checkState,' value="',settings.value,'">');return __element.append(__switch),__checked&&(__element.addClass("checked"),__element.attr("role","checkbox")),__element.on("tap",function(){var checkbox=this.querySelector("input");this.classList.contains("checked")?(this.classList.remove("checked"),this.setAttribute("aria-checked",!1),checkbox.removeAttribute("checked"),__selection.checked=!1,__checked=!1,settings.offCallback.call(this)):(this.classList.add("checked"),checkbox.setAttribute("checked","checked"),this.setAttribute("aria-checked",!0),__selection.checked=!0,__checked=!0,settings.onCallback.call(this))}),__element.on(swipeOn,function(){var checkbox=this.querySelector("input");this.classList.contains("checked")&&(this.classList.remove("checked"),this.setAttribute("aria-checked",!1),checkbox.removeAttribute("checked"),__selection.checked=!0,__checked=!0,settings.offCallback.call(this))}),__element.on(swipeOff,function(){var checkbox=this.querySelector("input");this.classList.contains("checked")||(this.classList.add("checked"),checkbox.setAttribute("checked","checked"),this.setAttribute("aria-checked",!0),__selection.checked=!1,__checked=!1,settings.onCallback.call(this))}),{getValue:function(){return __selection}}}}})}(),function(){"use strict";$.extend({Block:function(opacity){opacity=opacity?" style='opacity:"+opacity+"'":" style='opacity: .5;'",$(".mask")[0]||($("body").append("<div class='mask'"+opacity+"></div>"),$("screen.current").attr("aria-hidden",!0))},Unblock:function(){$(".mask").remove(),$("screen.current").removeAttr("aria-hidden")}})}(),function(){"use strict";$.extend({Popup:function(options){if(options){var settings={};settings.id=$.uuid(),settings.content=!0,$.extend(settings,options);var width="";settings.width&&(width=' style="width:'+settings.width+'px;" ');var panelClose,popup,id=settings.id,title=settings.title?"<header><h1>"+settings.title+"</h1></header>":"",message=settings.message?'<p role="note">'+options.message+"</p>":"",cancelButton=options.cancelButton?'<button class="cancel" role="button">'+settings.cancelButton+"</button>":"",continueButton=settings.continueButton?'<button class="continue" role="button">'+settings.continueButton+"</button>":"",callback=settings.callback||$.noop;popup=settings.empty?$.concat("<div"+width+' class="popup closed" role="alertdialog" id="',id,'"></div>'):$.concat('<div class="popup closed','" role="alertdialog" id="',id,'"><div class="panel">',title,message,"</div><footer>",cancelButton,continueButton,"</footer>",panelClose,"</div>"),$("body").append(popup),callback&&continueButton&&($(".popup").find(".continue").on($.eventStart,function(){var $this=$(this);$.isAndroid||$.isChrome?($this.addClass("selected"),setTimeout(function(){$this.removeClass("selected"),$(".popup").ClosePopup(),callback.call(callback)},300)):($(".popup").ClosePopup(),callback.call(callback))}),$(".popup").find(".cancel").on($.eventStart,function(){var $this=$(this);$.isAndroid||$.isChrome?($this.addClass("selected"),setTimeout(function(){$this.removeClass("selected"),$(".popup").ClosePopup()},300)):$(".popup").ClosePopup()})),$.CenterPopup();var events=$.eventStart+" tap "+$.eventEnd;$(".mask").on(events,function(e){e.stopPropagation()})}},CenterPopup:function(){var popup=$(".popup");if(popup[0]){var tmpLeft,tmpTop=window.innerHeight/2+window.pageYOffset-popup[0].clientHeight/2+"px";tmpLeft=320===window.innerWidth?"10px":Math.floor((window.innerWidth-popup[0].clientWidth)/2)+"px",$("body").hasClass("isWindows")?popup.css({top:tmpTop}):popup.css({left:tmpLeft,top:tmpTop})}}}),$.fn.extend({ShowPopup:function(){$.Block("0.5"),$(this).removeClass("closed"),$(this).addClass("opened"),$.CenterPopup()},ClosePopup:function(){$.Unblock(),$(this).removeClass("opened"),$(this).addClass("closed")}}),$(function(){window.onresize=function(){$.CenterPopup()}})}(),function(){"use strict";$(function(){$.extend({Segmented:function(options){function createSegmentedButton(){var __segmented=['<div class="segmented">'];labels.forEach(function(ctx,idx){settings.selected===idx?(__segmented.push('<button role="radio" aria-checked="true" class="selected">'),__selection=idx):__segmented.push('<button role="radio">'),__segmented.push(ctx),__segmented.push("</button>")}),__segmented.push("</div>"),segmented=__segmented.join(""),$(settings.element).append(segmented),__selection&&(__element=$(settings.element).find("button").eq(__selection))}if(options&&options.element){var settings={selected:0,callback:$.noop};$.extend(settings,options);var segmented,__selection,__element,labels=settings.labels?settings.labels:[];createSegmentedButton();var callback=settings.callback;return $(settings.element).on("tap",".segmented > button",function(e){var $this=$(this);this.parentNode.classList.contains("paging")||($this.siblings("button").removeClass("selected"),$this.siblings("button").removeAttr("aria-checked"),$this.addClass("selected"),__selection=$this.index(),__element=$(this),$this.attr("aria-checked",!0),callback.call(this,e))}),{getSelection:function(){return{index:__selection,element:__element}}}}}})})}(),function(){"use strict";$.fn.extend({Range:function(){if(!$("body").hasClass("isWindows")&&"INPUT"===this[0].nodeName){var newPlace,input=$(this),width=input.width(),newPoint=(input.val()-input.attr("min"))/(input.attr("max")-input.attr("min")),offset=-1.3;0>newPoint?newPlace=0:newPoint>1?newPlace=width:(newPlace=width*newPoint+offset,offset-=newPoint),$("body").hasClass("isAndroid")||$.isChrome?input.css({"background-size":Math.round(newPlace)+"px 3px, 100% 3px"}):input.css({"background-size":Math.round(newPlace)+"px 10px"})}}}),$(function(){$("input[type=range]").forEach(function(ctx){$(ctx).Range()}),$("body").on("input","input[type=range]",function(){$(this).Range()})})}(),function(){"use strict";$.extend({Sheet:function(options){if(options){var settings={id:$.uuid(),background:"",handle:!0,slideDown:!1};$.extend(settings,options),settings.background&&(settings.background=$.concat(' style="background-color:',settings.background,'" ')),settings.slideDown&&(settings.slideDown=' class="slideDown" '),settings.handle===!1?settings.handle="":settings.handle='<div class="handle"><span><svg width="100%" height="100%" viewBox="0 0 76 27" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:butt;stroke-linejoin:butt;stroke-miterlimit:1.41421;"><g id="sheet-handle" transform="matrix(1,0,0,1,-29.7966,-15.7797)"><path id="sheet-handle-path" d="M36.25,26.242L67.645,34.215L98.176,25.789" style="fill:none;"/></g></svg></span></div>';var sheet=$.concat('<sheet id="',settings.id,'"',settings.slideDown,settings.background,">",settings.handle,"<section></section></sheet>");$("body").append(sheet),$("#"+settings.id).find(".handle").on($.eventStart,function(){$.HideSheet("#"+settings.id)})}},ShowSheet:function(id){var sheet=id?id:".sheet";$("screen.current").addClass("blurred"),$.isAndroid||$.isChrome?($(sheet).css("display","block"),setTimeout(function(){$(sheet).addClass("opened")},20)):$(sheet).addClass("opened")},HideSheet:function(id){$(id).removeClass("opened"),$("screen.current").addClass("removeBlurSlow"),setTimeout(function(){$("screen").removeClass("blurred"),$("screen").removeClass("removeBlurSlow")},500)}})}(),function(){"use strict";$.extend({Paging:function(options){if(options&&options.element){var screen=$(options.element),pager='<div class="pager">\n      <button class="previous">\n        <svg width="24px" height="36px" viewBox="0 0 24 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="pagination-icons" stroke="#979797"><path d="M19.7729197,3 L4.25431067,17.8699971 L19.7729196,32.9558941" id="page-previous"></path></g></g></svg>\n      </button>\n      <button class="next">\n        <svg width="24px" height="36px" viewBox="0 0 24 36" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="pagination-icons" stroke="#979797"><path d="M4.08862955,3.06871359 L20.0261609,18.0528447 L4.08862956,32.9999994" id="page-next"></path></g></g></svg>\n      </button>\n      </div>';$(screen).find("nav").append(pager);var currentSection=$(screen).find("section"),articles=function(){return currentSection.find("article").length};$.AdjustNavbarLayout(screen);var pageForward=function($this){if(!(articles()<2)){$this.prev().removeClass("selected"),$this.addClass("selected");var currentArticle;$this[0].classList.contains("disabled")||(currentArticle=currentSection.find("article.current"),currentArticle.index()===articles()-1?(currentArticle.removeClass("current").addClass("next"),currentArticle.siblings().removeClass("previous").addClass("next"),currentSection.find("article").eq(0).addClass("current").removeClass("previous").removeClass("next")):(currentArticle.removeClass("current").addClass("previous"),currentArticle.next().removeClass("next").addClass("current")),setTimeout(function(){$this.removeClass("selected")},250))}},pageBack=function($this){if(1!==articles()){$this.next().removeClass("selected"),$this.addClass("selected");var currentArticle;currentArticle=currentSection.find("article.current"),0===currentArticle.index()?(currentArticle.removeClass("current"),currentArticle.siblings().eq(-1).addClass("current").removeClass("next"),currentArticle.siblings().eq(-1).siblings().removeClass("next").addClass("previous")):(currentArticle.removeClass("current").addClass("next"),currentArticle.prev().removeClass("previous").addClass("current")),setTimeout(function(){$this.removeClass("selected")},250)}};$(".pager").on($.eventStart,"button:last-of-type",function(){pageForward($(this))}),$(".pager").on($.eventStart,"button:first-of-type",function(){pageBack($(this))})}}})}(),function(){"use strict";$.extend({Stepper:function(options){if(options&&options.element&&options.min&&options.max){var stepper=$(options.element),min=options.min,max=options.max,defaultValue=options.defaultValue?options.defaultValue:options.min,increaseSymbol="+",decreaseSymbol="-";$.isWin&&(increaseSymbol="",decreaseSymbol="");var decreaseButton='<button class="decrease"><span>-</span></button>',label="<label>"+defaultValue+'</label><input type="text" value="'+defaultValue+'">',increaseButton='<button class="increase"><span>+</span></button>';stepper.append(decreaseButton+label+increaseButton),stepper.data("data-value",{min:min,max:max,defaultValue:defaultValue});var increaseStepperValue=function(){var newValue,currentValue=stepper.find("input").val(),value=stepper.data("data-value"),max=value.max;currentValue>=max?$(this).addClass("disabled"):(newValue=Number(currentValue)+1,stepper.find("button:first-of-type").removeClass("disabled"),stepper.find("label").text(newValue),stepper.find("input")[0].value=newValue,currentValue===max&&$(this).addClass("disabled"))},decreaseStepperValue=function(){var newValue,currentValue=stepper.find("input").val(),value=stepper.data("data-value"),min=value.min;min>=currentValue?$(this).addClass("disabled"):(newValue=Number(currentValue)-1,stepper.find("button:last-of-type").removeClass("disabled"),stepper.find("label").text(newValue),stepper.find("input")[0].value=newValue,currentValue===min&&$(this).addClass("disabled"))};return stepper.find("button:last-of-type").on("tap",function(){increaseStepperValue.call(this,stepper)}),stepper.find("button:first-of-type").on("tap",function(){decreaseStepperValue.call(this,stepper)}),{getValue:function(){return stepper.find("input").val()}}}}})}(),function(){"use strict";$.extend({Popover:function(options){options=options||{};var settings={id:$.uuid(),callback:$.noop,title:""};$.extend(settings,options),options&&options.content?settings.content=options.content:settings.content="";var header="<header><h1>"+settings.title+"</h1></header>",popover='<div class="popover" id="'+settings.id+'">'+header+"<section></section></div>",popoverID="#"+settings.id,__calcPopPos=function(element){var calcLeft,calcTop,offset=$(element).offset(),left=offset.left,popover=$(popoverID),popoverOffset=popover.offset();calcLeft=popoverOffset.left,calcTop=offset.top+$(element)[0].clientHeight,popover.width()+offset.left>window.innerWidth?popover.css({left:window.innerWidth-popover.width()-20+"px",top:calcTop+25+"px"}):popover.css({left:left+"px",top:calcTop-30+"px"})};return $(".mask")[0]?($.ClosePopover(),void $("body").Unblock()):($.Block(".5"),$("body").append(popover),$("body").hasClass("isAndroid")&&setTimeout(function(){$(popoverID).addClass("opened")},300),$("body").hasClass("isWindows")&&$(popoverID).addClass("open"),$(popoverID).data("triggerEl",settings.trigger),$(popoverID).find("section").append(settings.content),settings.callback.call(settings.callback,settings.trigger),void __calcPopPos(settings.trigger))},AlignPopover:function(){var popover=$(".popover");if(popover.length){var triggerID=popover.data("triggerEl"),offset=$(triggerID).offset(),left=offset.left;$(popover).width()+offset.left>window.innerWidth?popover.css({left:window.innerWidth-$(popover).width()-20+"px"}):popover.css({left:left+"px"})}},ClosePopover:function(){$.Unblock(),$(".popover").css("visibility","hidden"),setTimeout(function(){$(".popover").off(),$(".popover").remove()},10)}}),$(function(){window.onresize=function(){$.AlignPopover()};var events=$.eventStart+" singletap "+$.eventEnd;$("body").on(events,".mask",function(e){if($(".popover")[0])$.ClosePopover();else if(e&&1===e.nodeType)return})})}(),function(){"use strict";$.fn.extend({Center:function(position){if(this[0]){var $this=$(this),parent=$this.parent();position?$(this.css("position",position)):position="absolute"===$this.css("position")?"absolute":"relative";var height,width,parentHeight,parentWidth;"absolute"===position?(height=$this[0].clientHeight,width=$this[0].clientWidth,parentHeight=parent[0].clientHeight,parentWidth=parent[0].clientWidth):(height=parseInt($this.css("height"),10),width=parseInt($this.css("width"),10),parentHeight=parseInt(parent.css("height"),10),parentWidth=parseInt(parent.css("width"),10),$(this).css({"margin-left":"auto","margin-right":"auto"}));var tmpTop,tmpLeft;"body"===parent[0].nodeName?(tmpTop=window.innerHeight/2+window.pageYOffset-height/2+"px",tmpLeft=window.innerWidth/2-width/2+"px"):(tmpTop=parentHeight/2-height/2+"px",tmpLeft=parentWidth/2-width/2+"px"),"absolute"!==position&&(tmpLeft=0),$this.css({left:tmpLeft,top:tmpTop})}}})}(),function(){"use strict";$.fn.extend({Busy:function(options){var settings={size:40,color:"#666",position:!1};$.extend(settings,options);var spinner,$this=this,iOSBusy=function(){parseInt(settings.size,10)<30?(spinner="<svg class='truck-busy small' width='"+settings.size+"px' height='"+settings.size+"px' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' preserveAspectRatio='xMidYMid'>  <g x='0' y='0' width='100' height='100' fill='none' class='bk'><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(0 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(45 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(90 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(135 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(180 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(225 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(270 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(315 50 50) translate(0 -30)'></rect></g></svg>",$this.append(spinner)):(spinner="<svg class='truck-busy' width='"+settings.size+"px' height='"+settings.size+"px' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' preserveAspectRatio='xMidYMid' class='uil-default'> <g x='0' y='0' width='100' height='100' fill='none'><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(0 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(30 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(60 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(90 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(120 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(150 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(180 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(210 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(240 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(270 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(300 50 50) translate(0 -30)'></rect><rect  x='46.5' y='40' width='7' height='20' rx='5' ry='5' fill='"+settings.color+"' transform='rotate(330 50 50) translate(0 -30)'></rect></g></svg>",$this.append(spinner))},androidBusy=function(){settings.id=$.uuid();var androidActivityIndicator=null,position=settings.position?" "+settings.position:"";return $.isNativeAndroid?(androidActivityIndicator='<svg class="truck-busy'+position+'" version="1.1" id="'+settings.id+'" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><g><path fill="none" stroke="'+settings.color+'" stroke-width="10" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M74.2,65c2.7-4.4,4.3-9.5,4.3-15c0-15.7-12.8-28.5-28.5-28.5S21.5,34.3,21.5,50c0,5.5,1.6,10.6,4.3,15"/></g><polyline fill="none" stroke="'+settings.color+'" stroke-width="10" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="89.4,56.1 74.3,65 65.4,49.9 "/></svg>',void $this.append(androidActivityIndicator)):(androidActivityIndicator='<svg id="'+settings.id+'" class="truck-busy'+position+'" x="0px" y="0px" viewBox="0 0 100 100"><circle stroke="url(#SVGID_1_)" cx="50" cy="50" r="28.5"/></svg>',$this.append(androidActivityIndicator),$this.addClass("hasActivityIndicator"),settings.position&&$("#"+settings.id).addClass(settings.position),options.color&&$("#"+settings.id).find("circle").css("stroke",options.color),$("#"+settings.id).css({height:settings.size+"px",width:settings.size+"px"}),$("#"+settings.id))},winBusy=function(){var spinner=$('<progress class="truck-busy"></progress>');$(spinner).css({color:settings.color}),$(spinner).attr("role","progressbar"),$(spinner).addClass("win-ring"),settings.position&&$(spinner).addClass(settings.position),$this.append(spinner)};$("body").hasClass("isWindows")?winBusy(options):$("body").hasClass("isAndroid")?androidBusy(options):$("body").hasClass("isiOS")&&iOSBusy(options)}})}();